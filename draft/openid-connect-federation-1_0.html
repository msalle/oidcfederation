<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OpenID Connect Federation 1.0 - draft 15</title>
<meta content="Roland Hedberg" name="author">
<meta content="Michael B. Jones" name="author">
<meta content="Andreas Ã…kre Solberg" name="author">
<meta content="Samuel Gulliksson" name="author">
<meta content="John Bradley" name="author">
<meta content="
       
        The OpenID Connect standard specifies how a Relying Party (RP)
        can discover metadata about an OpenID Provider (OP), and then
        register to obtain RP credentials. The discovery and
        registration process does not involve any mechanisms of
        dynamically establishing trust in the exchanged information, but
        instead rely on out-of-band trust establishment.
       
       
        In an identity federation context, this is not sufficient. The
        participants of the federation must be able to trust information
        provided about other participants in the federation. OpenID
        Connect Federations specifies how trust can be dynamically
        obtained by resolving trust from a common trusted third party.
       
       
        While this specification is primarily targeting OpenID Connect,
        it is designed to allow for reuse by other
        protocols and in other use cases.
       
    " name="description">
<meta content="xml2rfc 3.7.0" name="generator">
<meta content="OpenID" name="keyword">
<meta content="Connect" name="keyword">
<meta content="Federation" name="keyword">
<meta content="openid-connect-federation-1_0" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.7.0
    Python 3.8.5
    appdirs 1.4.4
    ConfigArgParse 1.4
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.2.0
    PyYAML 5.3.1
    requests 2.25.1
    setuptools 49.6.0
    six 1.15.0
-->
<link href="draft/openid-connect-federation-1_0.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left"></td>
<td class="center">OpenID Connect Federation</td>
<td class="right">April 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hedberg, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">OpenID Connect Working Group</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. Hedberg, <span class="editor">Ed.</span>
</div>
<div class="org">independent</div>
</div>
<div class="author">
      <div class="author-name">M.B. Jones</div>
<div class="org">Microsoft</div>
</div>
<div class="author">
      <div class="author-name">A.Ã…. Solberg</div>
<div class="org">Uninett</div>
</div>
<div class="author">
      <div class="author-name">S. Gulliksson</div>
<div class="org">Schibsted</div>
</div>
<div class="author">
      <div class="author-name">J. Bradley</div>
<div class="org">Yubico</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OpenID Connect Federation 1.0 - draft 15</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
        The OpenID Connect standard specifies how a Relying Party (RP)
        can discover metadata about an OpenID Provider (OP), and then
        register to obtain RP credentials. The discovery and
        registration process does not involve any mechanisms of
        dynamically establishing trust in the exchanged information, but
        instead rely on out-of-band trust establishment.<a href="#section-abstract-1" class="pilcrow">Â¶</a></p>
<p id="section-abstract-2">
        In an identity federation context, this is not sufficient. The
        participants of the federation must be able to trust information
        provided about other participants in the federation. OpenID
        Connect Federations specifies how trust can be dynamically
        obtained by resolving trust from a common trusted third party.<a href="#section-abstract-2" class="pilcrow">Â¶</a></p>
<p id="section-abstract-3">
        While this specification is primarily targeting OpenID Connect,
        it is designed to allow for reuse by other
        protocols and in other use cases.<a href="#section-abstract-3" class="pilcrow">Â¶</a></p>
</section>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">â–²</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.Â Â <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.Â Â <a href="#name-requirements-language" class="xref">Requirements Language</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.Â Â <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.Â Â <a href="#name-components" class="xref">Components</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.Â Â <a href="#name-entity-statement" class="xref">Entity Statement</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.Â Â <a href="#name-trust-chain" class="xref">Trust Chain</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.Â Â <a href="#name-metadata" class="xref">Metadata</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.Â Â <a href="#name-rp-metadata" class="xref">RP Metadata</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.Â Â <a href="#name-op-metadata" class="xref">OP Metadata</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.Â Â <a href="#name-oauth-authorization-server" class="xref">OAuth Authorization Server</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.Â Â <a href="#name-oauth-client" class="xref">OAuth Client</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.Â Â <a href="#name-oauth-protected-resource" class="xref">OAuth Protected Resource</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.Â Â <a href="#name-federation-entity" class="xref">Federation Entity</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.Â Â <a href="#name-federation-policy" class="xref">Federation Policy</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.Â Â <a href="#name-metadata-policy" class="xref">Metadata Policy</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.Â Â <a href="#name-operators" class="xref">Operators</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.Â Â <a href="#name-restrictions-on-policy-entr" class="xref">Restrictions on Policy Entries</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="xref">4.1.3</a>.Â Â <a href="#name-combining-policies" class="xref">Combining Policies</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1.2.3.2.1">
                        <p id="section-toc.1-1.4.2.1.2.3.2.1.1"><a href="#section-4.1.3.1" class="xref">4.1.3.1</a>.Â Â <a href="#name-merging-operators" class="xref">Merging Operators</a></p>
</li>
                    </ul>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1.2.4">
                    <p id="section-toc.1-1.4.2.1.2.4.1"><a href="#section-4.1.4" class="xref">4.1.4</a>.Â Â <a href="#name-applying-policies" class="xref">Applying Policies</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1.2.5">
                    <p id="section-toc.1-1.4.2.1.2.5.1"><a href="#section-4.1.5" class="xref">4.1.5</a>.Â Â <a href="#name-policy-combination-example" class="xref">Policy Combination Example</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1.2.6">
                    <p id="section-toc.1-1.4.2.1.2.6.1"><a href="#section-4.1.6" class="xref">4.1.6</a>.Â Â <a href="#name-enforcing-policy" class="xref">Enforcing Policy</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1.2.7">
                    <p id="section-toc.1-1.4.2.1.2.7.1"><a href="#section-4.1.7" class="xref">4.1.7</a>.Â Â <a href="#name-extending-the-policy-langua" class="xref">Extending the Policy Language</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1.2.8">
                    <p id="section-toc.1-1.4.2.1.2.8.1"><a href="#section-4.1.8" class="xref">4.1.8</a>.Â Â <a href="#name-policy-example" class="xref">Policy Example</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.Â Â <a href="#name-applying-constraints" class="xref">Applying Constraints</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.Â Â <a href="#name-max-path-length" class="xref">Max Path Length</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.Â Â <a href="#name-naming-constraints" class="xref">Naming Constraints</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.Â Â <a href="#name-trust-marks" class="xref">Trust Marks</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="xref">4.3.1</a>.Â Â <a href="#name-trust-mark-properties" class="xref">Trust Mark Properties</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="xref">4.3.2</a>.Â Â <a href="#name-validating-a-trust-mark" class="xref">Validating a Trust Mark</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.3.2.3">
                    <p id="section-toc.1-1.4.2.3.2.3.1"><a href="#section-4.3.3" class="xref">4.3.3</a>.Â Â <a href="#name-trust-mark-example" class="xref">Trust Mark Example</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.Â Â <a href="#name-obtaining-federation-entity" class="xref">Obtaining Federation Entity Configuration Information</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.Â Â <a href="#name-federation-entity-configura" class="xref">Federation Entity Configuration Request</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.Â Â <a href="#name-federation-entity-configurat" class="xref">Federation Entity Configuration Response</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.Â Â <a href="#name-federation-api" class="xref">Federation API</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.Â Â <a href="#name-fetching-entity-statements-" class="xref">Fetching Entity Statements (REQUIRED)</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="xref">6.1.1</a>.Â Â <a href="#name-fetch-entity-statements-req" class="xref">Fetch Entity Statements Request</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="xref">6.1.2</a>.Â Â <a href="#name-fetch-entity-statements-res" class="xref">Fetch Entity Statements Response</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.Â Â <a href="#name-trust-negotiation-optional" class="xref">Trust Negotiation (OPTIONAL)</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="xref">6.2.1</a>.Â Â <a href="#name-trust-negotiation-request" class="xref">Trust Negotiation Request</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="xref">6.2.2</a>.Â Â <a href="#name-trust-negotiation-response" class="xref">Trust Negotiation Response</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.Â Â <a href="#name-entity-listings-optional" class="xref">Entity Listings (OPTIONAL)</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="xref">6.3.1</a>.Â Â <a href="#name-entity-listings-request" class="xref">Entity Listings Request</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.3.2.2">
                    <p id="section-toc.1-1.6.2.3.2.2.1"><a href="#section-6.3.2" class="xref">6.3.2</a>.Â Â <a href="#name-entity-listing-response" class="xref">Entity Listing Response</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.Â Â <a href="#name-generic-error-response" class="xref">Generic Error Response</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.Â Â <a href="#name-resolving-trust-chain-and-m" class="xref">Resolving Trust Chain and Metadata</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.Â Â <a href="#name-fetching-entity-statements-t" class="xref">Fetching Entity Statements to Establish a Trust Chain</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.Â Â <a href="#name-validating-a-trust-chain" class="xref">Validating a Trust Chain</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.Â Â <a href="#name-choosing-one-of-the-valid-t" class="xref">Choosing One of the Valid Trust Chains</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.Â Â <a href="#name-calculating-the-expiration-" class="xref">Calculating the Expiration Time of a Trust Chain</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.Â Â <a href="#name-updating-metadata-key-rollo" class="xref">Updating Metadata, Key Rollover, and Revocation</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.Â Â <a href="#name-protocol-key-rollover" class="xref">Protocol Key Rollover</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.Â Â <a href="#name-key-rollover-for-a-trust-an" class="xref">Key Rollover for a Trust Anchor</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.Â Â <a href="#name-revocation" class="xref">Revocation</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.Â Â <a href="#name-openid-connect-communicatio" class="xref">OpenID Connect Communication</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.Â Â <a href="#name-automatic-registration" class="xref">Automatic Registration</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a href="#section-9.1.1" class="xref">9.1.1</a>.Â Â <a href="#name-authentication-request" class="xref">Authentication Request</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.1.2.1.2.1">
                        <p id="section-toc.1-1.9.2.1.2.1.2.1.1"><a href="#section-9.1.1.1" class="xref">9.1.1.1</a>.Â Â <a href="#name-using-a-request-object" class="xref">Using a Request Object</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.1.2.1.2.1.2.1">
                            <p id="section-toc.1-1.9.2.1.2.1.2.1.2.1.1"><a href="#section-9.1.1.1.1" class="xref">9.1.1.1.1</a>.Â Â <a href="#name-processing-the-authenticati" class="xref">Processing the Authentication Request</a></p>
</li>
                        </ul>
</li>
                      <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.1.2.1.2.2">
                        <p id="section-toc.1-1.9.2.1.2.1.2.2.1"><a href="#section-9.1.1.2" class="xref">9.1.1.2</a>.Â Â <a href="#name-using-pushed-authorization" class="xref">Using Pushed Authorization</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.1.2.1.2.2.2.1">
                            <p id="section-toc.1-1.9.2.1.2.1.2.2.2.1.1"><a href="#section-9.1.1.2.1" class="xref">9.1.1.2.1</a>.Â Â <a href="#name-processing-the-authenticatio" class="xref">Processing the Authentication Request</a></p>
</li>
                        </ul>
</li>
                    </ul>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.1.2.2">
                    <p id="section-toc.1-1.9.2.1.2.2.1"><a href="#section-9.1.2" class="xref">9.1.2</a>.Â Â <a href="#name-authentication-error-respon" class="xref">Authentication Error Response</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.Â Â <a href="#name-explicit-registration" class="xref">Explicit Registration</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a href="#section-9.2.1" class="xref">9.2.1</a>.Â Â <a href="#name-client-registration" class="xref">Client Registration</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.2.2.1.2.1">
                        <p id="section-toc.1-1.9.2.2.2.1.2.1.1"><a href="#section-9.2.1.1" class="xref">9.2.1.1</a>.Â Â <a href="#name-client-registration-request" class="xref">Client Registration Request</a></p>
</li>
                      <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.2.2.1.2.2">
                        <p id="section-toc.1-1.9.2.2.2.1.2.2.1"><a href="#section-9.2.1.2" class="xref">9.2.1.2</a>.Â Â <a href="#name-client-registration-respons" class="xref">Client Registration Response</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.2.2.1.2.2.2.1">
                            <p id="section-toc.1-1.9.2.2.2.1.2.2.2.1.1"><a href="#section-9.2.1.2.1" class="xref">9.2.1.2.1</a>.Â Â <a href="#name-op-constructing-the-respons" class="xref">OP Constructing the Response</a></p>
</li>
                          <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.2.2.1.2.2.2.2">
                            <p id="section-toc.1-1.9.2.2.2.1.2.2.2.2.1"><a href="#section-9.2.1.2.2" class="xref">9.2.1.2.2</a>.Â Â <a href="#name-rp-parsing-the-response" class="xref">RP Parsing the Response</a></p>
</li>
                        </ul>
</li>
                    </ul>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.2.2.2">
                    <p id="section-toc.1-1.9.2.2.2.2.1"><a href="#section-9.2.2" class="xref">9.2.2</a>.Â Â <a href="#name-after-client-registration" class="xref">After Client Registration</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.2.2.2.2.1">
                        <p id="section-toc.1-1.9.2.2.2.2.2.1.1"><a href="#section-9.2.2.1" class="xref">9.2.2.1</a>.Â Â <a href="#name-what-the-rp-must-do" class="xref">What the RP MUST Do</a></p>
</li>
                      <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.2.2.2.2.2">
                        <p id="section-toc.1-1.9.2.2.2.2.2.2.1"><a href="#section-9.2.2.2" class="xref">9.2.2.2</a>.Â Â <a href="#name-what-the-op-must-do" class="xref">What the OP MUST Do</a></p>
</li>
                    </ul>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.2.2.3">
                    <p id="section-toc.1-1.9.2.2.2.3.1"><a href="#section-9.2.3" class="xref">9.2.3</a>.Â Â <a href="#name-expiration-times" class="xref">Expiration Times</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>.Â <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>.Â <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>.Â <a href="#name-references" class="xref">References</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="xref">12.1</a>.Â Â <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="xref">12.2</a>.Â Â <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.Â Â <a href="#name-provider-information-discov" class="xref">Provider Information Discovery and Client Registration in a Federation</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.Â Â <a href="#name-the-ligo-wiki-discovers-the" class="xref">The LIGO Wiki Discovers the OP's Metadata</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.13.2.1.2.1">
                    <p id="section-toc.1-1.13.2.1.2.1.1"><a href="#section-a.1.1" class="xref">A.1.1</a>.Â Â <a href="#name-configuration-information-f" class="xref">Configuration Information for op.umu.se</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.13.2.1.2.2">
                    <p id="section-toc.1-1.13.2.1.2.2.1"><a href="#section-a.1.2" class="xref">A.1.2</a>.Â Â <a href="#name-configuration-information-fo" class="xref">Configuration Information for 'https://umu.se'</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.13.2.1.2.3">
                    <p id="section-toc.1-1.13.2.1.2.3.1"><a href="#section-a.1.3" class="xref">A.1.3</a>.Â Â <a href="#name-entity-statement-published-" class="xref">Entity Statement Published by 'https://umu.se' about 'https://op.umu.se'</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.13.2.1.2.4">
                    <p id="section-toc.1-1.13.2.1.2.4.1"><a href="#section-a.1.4" class="xref">A.1.4</a>.Â Â <a href="#name-configuration-information-for" class="xref">Configuration Information for 'https://swamid.se'</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.13.2.1.2.5">
                    <p id="section-toc.1-1.13.2.1.2.5.1"><a href="#section-a.1.5" class="xref">A.1.5</a>.Â Â <a href="#name-entity-statement-published-b" class="xref">Entity Statement Published by 'https://swamid.se' about 'https://umu.se'</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.13.2.1.2.6">
                    <p id="section-toc.1-1.13.2.1.2.6.1"><a href="#section-a.1.6" class="xref">A.1.6</a>.Â Â <a href="#name-configuration-information-for-" class="xref">Configuration Information for 'https://edugain.geant.org'</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.13.2.1.2.7">
                    <p id="section-toc.1-1.13.2.1.2.7.1"><a href="#section-a.1.7" class="xref">A.1.7</a>.Â Â <a href="#name-entity-statement-published-by" class="xref">Entity Statement Published by 'https://edugain.geant.org' about 'https://swamid.se'</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.13.2.1.2.8">
                    <p id="section-toc.1-1.13.2.1.2.8.1"><a href="#section-a.1.8" class="xref">A.1.8</a>.Â Â <a href="#name-verified-metadata-for-opumu" class="xref">Verified Metadata for op.umu.se</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.Â Â <a href="#name-the-two-ways-of-doing-clien" class="xref">The Two Ways of Doing Client Registration</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.13.2.2.2.1">
                    <p id="section-toc.1-1.13.2.2.2.1.1"><a href="#section-a.2.1" class="xref">A.2.1</a>.Â Â <a href="#name-rp-sends-authentication-req" class="xref">RP Sends Authentication Request (Automatic Registration)</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.13.2.2.2.1.2.1">
                        <p id="section-toc.1-1.13.2.2.2.1.2.1.1"><a href="#section-a.2.1.1" class="xref">A.2.1.1</a>.Â Â <a href="#name-op-fetches-entity-statement" class="xref">OP Fetches Entity Statements</a></p>
</li>
                      <li class="ulEmpty toc compact" id="section-toc.1-1.13.2.2.2.1.2.2">
                        <p id="section-toc.1-1.13.2.2.2.1.2.2.1"><a href="#section-a.2.1.2" class="xref">A.2.1.2</a>.Â Â <a href="#name-op-evaluates-the-rp-metadat" class="xref">OP Evaluates the RP Metadata</a></p>
</li>
                    </ul>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.13.2.2.2.2">
                    <p id="section-toc.1-1.13.2.2.2.2.1"><a href="#section-a.2.2" class="xref">A.2.2</a>.Â Â <a href="#name-client-starts-with-registra" class="xref">Client Starts with Registration (Explicit Client Registration)</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.Â Â <a href="#name-notices" class="xref">Notices</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-appendix.c" class="xref">Appendix C</a>.Â Â <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-appendix.d" class="xref">Appendix D</a>.Â Â <a href="#name-open-issues" class="xref">Open Issues</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-appendix.e" class="xref">Appendix E</a>.Â Â <a href="#name-document-history" class="xref">Document History</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#section-appendix.f" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="Introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
        This specification describes how two entities that would like to
        interact can dynamically fetch and resolve trust and metadata for a
        given protocol through the use of third-party trust anchor. A trust
        anchor is an entity whose main purpose is to issue statements
        about entities, such as OpenID Connect Relying Parties, OpenID
        Providers, and participating organizations.
        An identity federation can be realized using this specification using
        one or more levels of trust issuers. This specification does not mandate
        a specific way or restrict how a federation may be built. Instead, the
        specification provides the basic technical trust infrastructure building
        blocks needed to build a dynamic and distributed trust network such as a
        federation.<a href="#section-1-1" class="pilcrow">Â¶</a></p>
<p id="section-1-2">
        Note that this specification only concerns itself with how two entities
        in a federation get to know about each other it does not change
        any other functionality in OpenID Connect.<a href="#section-1-2" class="pilcrow">Â¶</a></p>
<p id="section-1-3">
        Note that a company, as with any real-world organization, may be
        represented by more than one entity in a federation.<a href="#section-1-3" class="pilcrow">Â¶</a></p>
<p id="section-1-4">
        OpenID Connect Federation trust chains rely on
        cryptographically signed
        <span><a href="#RFC7519" class="xref">JSON Web Token (JWT)</a> [<a href="#RFC7519" class="xref">RFC7519</a>]</span>
        documents,
        and the trust chain does not at
        all rely on TLS
        <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>
        to establish trust.<a href="#section-1-4" class="pilcrow">Â¶</a></p>
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.1-1">
          The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
          "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
          document are to be interpreted as described in
          <span><a href="#RFC2119" class="xref">RFC 2119</a> [<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-1.1-1" class="pilcrow">Â¶</a></p>
</section>
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">
          This specification uses the terms
          "Claim Name", "Claim Value", "JSON Web Token (JWT)",
          defined by
          <span><a href="#RFC7519" class="xref">JSON Web Token (JWT)</a> [<a href="#RFC7519" class="xref">RFC7519</a>]</span>
          and the terms "OpenID Provider (OP)" and "Relying Party (RP)" defined
          by <span><a href="#OpenID.Core" class="xref">OpenID Connect Core 1.0</a> [<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span>.<a href="#section-1.2-1" class="pilcrow">Â¶</a></p>
<p id="section-1.2-2">
          This specification also defines the following terms:<a href="#section-1.2-2" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-1.2-3">
          <dt id="section-1.2-3.1">Entity</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.2">
              Something that has a separate and distinct existence and that can
              be identified in a context. All entities in an OpenID Connect
              federation MUST have a globally unique identifier.<a href="#section-1.2-3.2" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.3">Entity identifier</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.4">
              An URI that is globally unique and that is bound to one Entity.<a href="#section-1.2-3.4" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.5">Entity statement</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.6">
              An entity statement is
              issued by an entity, which pertains to a subject entity and leaf
              entities. An entity statement is always a signed JWT.<a href="#section-1.2-3.6" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.7">Intermediate entity</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.8">
              An entity that issues
              an entity statement that appears somewhere in between those
              issued by the trust anchor and the leaf entity in a trust chain.<a href="#section-1.2-3.8" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.9">Leaf Entity</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.10">
              An entity defined by a certain protocol,
              e.g., OpenID Connect Relying Party or Provider.<a href="#section-1.2-3.10" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.11">Trust Anchor</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.12">
              An entity that represents a trusted third party.<a href="#section-1.2-3.12" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.13">Trust Chain</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.14">
              A sequence of entity statements that represents a chain
              starting at a leaf entity and ending in a trust anchor.<a href="#section-1.2-3.14" class="pilcrow">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</section>
</div>
<div id="components">
<section id="section-2">
      <h2 id="name-components">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-components" class="section-name selfRef">Components</a>
      </h2>
<div id="entity-statement">
<section id="section-2.1">
        <h3 id="name-entity-statement">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-entity-statement" class="section-name selfRef">Entity Statement</a>
        </h3>
<p id="section-2.1-1">
          An entity statement is
          issued by an entity and concerns a subject entity and leaf entities
          in a federation. An entity statement is always a signed JWT.
          All entities in a federation SHOULD be prepared to publish an entity
          statement about themselves. If they are not able to do so themselves
          someone else MUST do it for them.<a href="#section-2.1-1" class="pilcrow">Â¶</a></p>
<p id="section-2.1-2">
          An entity statement is composed of the following claims:<a href="#section-2.1-2" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2.1-3">
          <dt id="section-2.1-3.1">iss</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-3.2">
              REQUIRED. The entity identifier of the issuer of
              the statement. If the <code>iss</code> and
              the <code>sub</code> are identical, the
              issuer is making a statement about itself.<a href="#section-2.1-3.2" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-3.3">sub</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-3.4">
              REQUIRED. The entity identifier of the subject<a href="#section-2.1-3.4" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-3.5">iat</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-3.6">
              REQUIRED. The time the statement was issued.
              Its value is a JSON number representing the number of seconds from
              1970-01-01T0:0:0Z as measured in UTC until the date/time.
              See <span><a href="#RFC3339" class="xref">RFC 3339</a> [<a href="#RFC3339" class="xref">RFC3339</a>]</span> for
              details regarding date/times in general and UTC in particular.<a href="#section-2.1-3.6" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-3.7">exp</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-3.8">
              REQUIRED.
              Expiration time on or after which the statement MUST NOT be
              accepted for processing. Its value is a JSON number representing
              the number of seconds from 1970-01-01T0:0:0Z as measured in UTC
              until the date/time.<a href="#section-2.1-3.8" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-3.9">jwks</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-3.10">
              OPTIONAL. A
              <span><a href="#RFC7517" class="xref">JSON Web Key Set (JWKS)</a> [<a href="#RFC7517" class="xref">RFC7517</a>]</span>
              representing the public part of the subject
              entity's signing keys. The corresponding private key is
              used by leaf entities to sign entity statements about themselves,
              and intermediate entities to sign statements about other entities.
              The keys that can be found here are primarily intended to sign
              entity statements and should not be used in other protocols.
              This claim is only optional for the entity statement returned
              from an OP when the client is doing explicit registration.
              In all other cases it is REQUIRED.
              Every JWK in the JWKS MUST have a key id (kid).<a href="#section-2.1-3.10" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-3.11">aud</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-3.12">
              OPTIONAL.
              The entity statement may be specifically created for an entity.
              The entity identifier for that entity MUST appear in this claim.<a href="#section-2.1-3.12" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-3.13">authority_hints</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-3.14">
              OPTIONAL. Array of strings representing
              the entity identifiers of intermediate entities or trust anchors
              that may issue an entity statement about the issuer entity.
              For all entities except for trust anchors that do not have any
              superiors this is REQUIRED and MUST NOT be the empty list [].
              This claim MUST be absent from an
              entity statement issued by a trust anchor with no superiors.<a href="#section-2.1-3.14" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-3.15">metadata</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-3.16">
              OPTIONAL. JSON object including protocol
              specific metadata claims that represent the entity's metadata.
              Each key of the JSON object represents a metadata type
              identifier, and each value MUST be a JSON object representing
              the metadata according to the metadata schema of that metadata
              type. An entity statement may contain multiple
              metadata statements, but only one for each metadata type.
              If the <code>iss</code> of an entity statement
              points to the same entity as the
              <code>sub</code>,
              then the entity statement MUST contain a
              <code>metadata</code>
              claim.
              If <code>iss</code> and
              <code>sub</code>
              are not the same,
              then the entity statement MUST NOT contain a
              <code>metadata</code>
              claim.<a href="#section-2.1-3.16" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-3.17">metadata_policy</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-3.18">
              OPTIONAL. JSON object that describes
              a metadata policy.
              Each key of the JSON object represents a metadata type
              identifier, and each value MUST be a JSON object representing
              the metadata policy according to the metadata schema of that
              metadata type. An entity statement may contain multiple
              metadata policy statements, but only one for each metadata type.
              Only non-leaf entities MAY contain a
              <code>metadata_policy</code>
              claim. Leaf entities MUST NOT contain a
       <code>metadata_policy</code> claim.<a href="#section-2.1-3.18" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-3.19">constraints</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-3.20">
              OPTIONAL. JSON object that describes a set of trust chain
              constraints. More about this in
              <a href="#chain_constraints" class="xref">Section 4.2</a><a href="#section-2.1-3.20" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-3.21">crit</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-3.22">
              OPTIONAL.
              The <code>crit</code> (critical) entity statement
              claim
              indicates that extensions to entity statement claims defined by
              this specification
              are being used that MUST be understood and processed.
              It is used in the same way that
              <code>crit</code>
              is used for extension <span><a href="#RFC7515" class="xref">JWS</a> [<a href="#RFC7515" class="xref">RFC7515</a>]</span> header
              parameters that MUST be understood and processed.
              Its value is an array listing the entity statement claims
              present in the entity statement that use those extensions.
              If any of the listed extension entity statement claims are not
              understood and supported by the recipient, then the entity
              statement is invalid.
              Producers MUST NOT include entity statement claim names defined by
              this specification or
              names that do not occur as entity statement claim names in the
              entity statement
              in the <code>crit</code> list.
              Producers MUST NOT use the empty list
              <code>[]</code>
              as the <code>crit</code> value.<a href="#section-2.1-3.22" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-3.23">policy_language_crit</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-3.24">
              OPTIONAL.
              The <code>policy_language_crit</code> (critical)
              entity statement claim
              indicates that extensions to the policy language defined by this
              specification
              are being used that MUST be understood and processed.
              It is used in the same way that
              <code>crit</code>
              is used for extension
              <span><a href="#RFC7515" class="xref">JSON Web Signature (JWS)</a> [<a href="#RFC7515" class="xref">RFC7515</a>]</span>
              header parameters that MUST be
              understood and processed.
              Its value is an array listing the policy language extensions
              present in the policy language statements that use those
              extensions.
              If any of the listed extension policy language extensions are not
              understood and supported by the recipient, then the entity
              statement is invalid.
              Producers MUST NOT include policy language names defined by this
              specification or
              names that do not occur in policy language statements in the
              entity statement
              in the <code>policy_language_crit</code> list.
              Producers MUST NOT use the empty list
              <code>[]</code>
              as the <code>policy_language_crit</code> value.<a href="#section-2.1-3.24" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-3.25">trust_marks</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-3.26">
              OPTIONAL. JSON object that describes a set of trust marks.
              More about this in
              <a href="#trust_marks" class="xref">Section 4.3</a><a href="#section-2.1-3.26" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-3.27">trust_anchor_id</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-3.28">
              OPTIONAL.
              An OP MUST use this claim to tell the RP which trust anchor it
              chose to use when responding to an explicit client registration.
              The value of <code>trust_anchor_id</code> is the entity identifier of a trust
              anchor.<a href="#section-2.1-3.28" class="pilcrow">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.1-4">
          The entity statement is signed using the private key of the issuer
          entity, in the form of a <span><a href="#RFC7515" class="xref">JSON Web Signature
          (JWS)</a> [<a href="#RFC7515" class="xref">RFC7515</a>]</span>. Entities MUST support signing Entity Statements with
          the RSA SHA-256 algorithm (an <code>alg</code>
   value of <code>RS256</code>). Consequently
          entities MUST support signature verification where the statement was
          signed using RS256.<a href="#section-2.1-4" class="pilcrow">Â¶</a></p>
<p id="section-2.1-5" class="keepWithNext">
            The following is a non-normative example of an entity statement
            before
            serialization and adding a signature. The example contains
            a critical extension <code>jti</code> (JWT ID) to the
            entity statement and one critical extension to the policy language
            <code>regexp</code>
            (Regular expression).<a href="#section-2.1-5" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.1-6">
<pre>
{
  "iss": "https://feide.no",
  "sub": "https://ntnu.no",
  "iat": 1516239022,
  "exp": 1516298022,
  "crit": ["jti"],
  "jti": "7l2lncFdY6SlhNia",
  "policy_language_crit": ["regexp"],
  "metadata_policy": {
    "openid_provider": {
      "issuer": {"value": "https://ntnu.no"},
      "organization_name": {"value": "NTNU"},
      "id_token_signing_alg_values_supported":
        {"subset_of": ["RS256", "RS384", "RS512"]},
      "op_policy_uri": {
        "regexp":
          "^https:\/\/[\\w-]+\\.example\\.com\/[\\w-]+\\.html"}
    },
    "openid_relying_party": {
      "organization_name": {"value": "NTNU"},
      "grant_types_supported": {
        "subset_of": ["authorization_code", "implicit"]},
      "scopes": {
        "subset_of": ["openid", "profile", "email", "phone"]}
    }
  },
  "constraints": {
    "max_path_length": 2
  },
  "jwks": {
    "keys": [
      {
        "alg": "RS256",
        "e": "AQAB",
        "key_ops": ["verify"],
        "kid": "key1",
        "kty": "RSA",
        "n": "pnXBOusEANuug6ewezb9J_...",
        "use": "sig"
      }
    ]
  },
  "authority_hints": [
    "https://edugain.org/federation"
  ]
}
</pre><a href="#section-2.1-6" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="trust_chain">
<section id="section-2.2">
        <h3 id="name-trust-chain">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-trust-chain" class="section-name selfRef">Trust Chain</a>
        </h3>
<p id="section-2.2-1">
          In an OpenID Connect Identity Federation, entities that together build
          a trust chain can be categorized as:<a href="#section-2.2-1" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2.2-2">
          <dt id="section-2.2-2.1">Trust anchor</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.2">
              An entity that represents a trusted
              third party.<a href="#section-2.2-2.2" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.3">Leaf</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.4">
              In an OpenID Connect Identity Federation, an RP or an OP.<a href="#section-2.2-2.4" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.5">Intermediate</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.6">
              Neither a leaf nor a trust anchor.<a href="#section-2.2-2.6" class="pilcrow">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.2-3">
          A trust chain begins with a leaf entity's self-signed entity
          statement, has zero or more entity statements
          issued by intermediates about subordinates, and ends with an
          entity statement issued by the trust anchor about the top-most
          intermediate (if there are intermediates) or the leaf entity
          (if there are no intermediates).<a href="#section-2.2-3" class="pilcrow">Â¶</a></p>
<p id="section-2.2-4">
          A simple example: If we have an RP that belongs to organization A
          that is a member of federation F, the trust chain for such a setup
          will contain the following entity statements:<a href="#section-2.2-4" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.2-5">
<li id="section-2.2-5.1">
              a self-signed entity statement about the RP published by the RP,<a href="#section-2.2-5.1" class="pilcrow">Â¶</a>
</li>
          <li id="section-2.2-5.2">
              an entity statement about the RP published by Organization A, and<a href="#section-2.2-5.2" class="pilcrow">Â¶</a>
</li>
          <li id="section-2.2-5.3">
              an entity statement about Organization A published by Federation.
              F<a href="#section-2.2-5.3" class="pilcrow">Â¶</a>
</li>
        </ol>
<p id="section-2.2-6">
          A trust chain MUST always be possible to order such that:
          If we name the entity statements ES[0] (the leaf entity's
          self-signed entity statement) to ES[i] (an entity statement issued
          by the trust anchor), i&gt;0 then:<a href="#section-2.2-6" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-7.1">
              The <code>iss</code> entity in one entity statement
              is always the
              <code>sub</code>
              entity in the next.
              ES[j]['iss'] == ES[j+1]['sub'], j=0,...,i-1 .<a href="#section-2.2-7.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-2.2-7.2">
              There MUST always be a signing key carried in the
              <code>jwks</code>
              claim in
              ES[j] that can be used to verify the signature of ES[j-1],
              j=i,...,1 .<a href="#section-2.2-7.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-2.2-7.3">
              It MUST be possible to verify the signature of ES[0] with
              one of the keys in ES[0]['jwks'].<a href="#section-2.2-7.3" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-2.2-8">
          The signing key that MUST be used to verify ES[i] is distributed
          from the trust anchors to any entity that needs to verify a
          trust chain in some secure out-of-band way not described in this
          document.<a href="#section-2.2-8" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="metadata">
<section id="section-3">
      <h2 id="name-metadata">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-metadata" class="section-name selfRef">Metadata</a>
      </h2>
<p id="section-3-1">
        This specification does allow new metadata
        types to be defined, to support use cases outside OpenID Connect
        federations.
        The metadata type identifier will uniquely identify which metadata
        specification to utilize.<a href="#section-3-1" class="pilcrow">Â¶</a></p>
<p id="section-3-2">
        The metadata document MUST be a JSON document. Beyond that there is
        no restriction.<a href="#section-3-2" class="pilcrow">Â¶</a></p>
<p id="section-3-3">
        Metadata used in federations typically reuses existing metadata
        standards.
        If needed, the metadata schema is extended
        with additional properties relevant in a federated context.
        For instance, for OpenID Connect Federations, this specification uses
        metadata values from
        <span><a href="#OpenID.Discovery" class="xref">OpenID Connect Discovery 1.0</a> [<a href="#OpenID.Discovery" class="xref">OpenID.Discovery</a>]</span>
        and
        <span><a href="#OpenID.Registration" class="xref">OpenID Connect Dynamic Client
          Registration 1.0</a> [<a href="#OpenID.Registration" class="xref">OpenID.Registration</a>]</span>
        and adds additional
        values used for federations.<a href="#section-3-3" class="pilcrow">Â¶</a></p>
<div id="RP_metadata">
<section id="section-3.1">
        <h3 id="name-rp-metadata">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-rp-metadata" class="section-name selfRef">RP Metadata</a>
        </h3>
<p id="section-3.1-1">
          The metadata type identifier is
          <code>openid_relying_party</code>.<a href="#section-3.1-1" class="pilcrow">Â¶</a></p>
<p id="section-3.1-2">
          All parameters defined in Section 2 of
          <span><a href="#OpenID.Registration" class="xref">OpenID Connect Dynamic Client
            Registration 1.0</a> [<a href="#OpenID.Registration" class="xref">OpenID.Registration</a>]</span>
          are allowed in a metadata statement.<a href="#section-3.1-2" class="pilcrow">Â¶</a></p>
<p id="section-3.1-3">
          To that list is added:<a href="#section-3.1-3" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.1-4">
          <dt id="section-3.1-4.1">client_registration_types</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-4.2">
              REQUIRED. Array of strings specifying the client registration
              types the RP wants to use. Values defined by this specification
              are
              <code>automatic</code>
              and <code>explicit</code>.<a href="#section-3.1-4.2" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-4.3">organization_name</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-4.4">
              OPTIONAL. A human-readable
              name representing the organization owning the RP.<a href="#section-3.1-4.4" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-4.5">signed_jwks_uri</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-4.6">
            <p id="section-3.1-4.6.1">
              OPTIONAL. A URI pointing to a signed JWT having the entity's
              JWKS as payload. The JWT is signed with a key that was included
              in the JWK that the entity published in its self-signed entity
              statement.
              A signed JWT can contain the following claims all, except
              <code>keys</code>, defined in
              <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span>:<a href="#section-3.1-4.6.1" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.1-4.6.2">
              <dt id="section-3.1-4.6.2.1">keys</dt>
              <dd style="margin-left: 1.5em" id="section-3.1-4.6.2.2">
                  REQUIRED. List of JWKs<a href="#section-3.1-4.6.2.2" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1-4.6.2.3">iss</dt>
              <dd style="margin-left: 1.5em" id="section-3.1-4.6.2.4">
                  REQUIRED. The "iss" (issuer) claim identifies the principal
                  that issued the JWT.<a href="#section-3.1-4.6.2.4" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1-4.6.2.5">sub</dt>
              <dd style="margin-left: 1.5em" id="section-3.1-4.6.2.6">
                  REQUIRED. This claim identifies the owner of the keys.
                  Should be the same as the issuer.<a href="#section-3.1-4.6.2.6" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1-4.6.2.7">iat</dt>
              <dd style="margin-left: 1.5em" id="section-3.1-4.6.2.8">
                  OPTIONAL. This claim identifies the time at which the JWT was
                  issued.<a href="#section-3.1-4.6.2.8" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1-4.6.2.9">exp</dt>
              <dd style="margin-left: 1.5em" id="section-3.1-4.6.2.10">
                  OPTIONAL. This claim identifies the time at which the JWT is
                  not valid anymore.<a href="#section-3.1-4.6.2.10" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-3.1-4.6.3">
              There are more claims defined in <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span> of
              these <code>aud</code> is out of the question since
              the issuer can not know who the audience is.
              <code>nbf</code> and <code>jti</code>
              are deemed to not be very useful in this context and are there for
              left out.<a href="#section-3.1-4.6.3" class="pilcrow">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.1-5" class="keepWithNext">
            The following is a non-normative example of a signed JWKS
            before serialization and adding a signature.<a href="#section-3.1-5" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.1-6">
<pre>
{
  'keys': [
    {
      'kty': 'RSA',
      'kid': 'SUdtUndEWVY2cUFDeDV5NVlBWDhvOXJodVl2am1mNGNtR0pmd',
      'n': 'y_Zc8rByfeRIC9fFZrDZ2MGH2ZnxLrc0ZNNwkNet5rwCPYeRF3Sv
            5nihZA9NHkDTEX97dN8hG6ACfeSo6JB2P7heJtmzM8oOBZbmQ90n
            EA_JCHszkejHaOtDDfxPH6bQLrMlItF4JSUKua301uLB7C8nzTxm
            tF3eAhGCKn8LotEseccxsmzApKRNWhfKDLpKPe9i9PZQhhJaurwD
            kMwbWTAeZbqCScU1o09piuK1JDf2PaDFevioHncZcQO74Obe4nN3
            oNPNAxrMClkZ9s9GMEd5vMqOD4huXlRpHwm9V3oJ3LRutOTxqQLV
            yPucu7eHA7her4FOFAiUk-5SieXL9Q',
      'e': 'AQAB'
    },
    {
      'kty': 'EC',
      'kid': 'MFYycG1raTI4SkZvVDBIMF9CNGw3VEZYUmxQLVN2T21nSWlkd3',
      'crv': 'P-256',
      'x': 'qAOdPQROkHfZY1daGofOmSNQWpYK8c9G2m2Rbkpbd4c',
      'y': 'G_7fF-T8n2vONKM15Mzj4KR_shvHBxKGjMosF6FdoPY'
    }
  ],
  'iss': 'https://example.org/op',
  'iat': 1618410883
}
</pre><a href="#section-3.1-6" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="OP_metadata">
<section id="section-3.2">
        <h3 id="name-op-metadata">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-op-metadata" class="section-name selfRef">OP Metadata</a>
        </h3>
<p id="section-3.2-1">
          The metadata type identifier is
          <code>openid_provider</code>.<a href="#section-3.2-1" class="pilcrow">Â¶</a></p>
<p id="section-3.2-2">
          All parameters defined in Section 3 of
          <span><a href="#OpenID.Discovery" class="xref">OpenID Connect Discovery 1.0</a> [<a href="#OpenID.Discovery" class="xref">OpenID.Discovery</a>]</span>
          are applicable.<a href="#section-3.2-2" class="pilcrow">Â¶</a></p>
<p id="section-3.2-3">
          In addition, the following parameters are defined by this
          specification:<a href="#section-3.2-3" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.2-4">
          <dt id="section-3.2-4.1">client_registration_types_supported</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-4.2">
              REQUIRED. Array specifying the federation types supported.
              Federation type values defined by this specification are
              <code>automatic</code>
              and <code>explicit</code>.<a href="#section-3.2-4.2" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-4.3">organization_name</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-4.4">
              OPTIONAL. A human-readable
              name representing the organization owning the OP. It is
              intended to be used in the user interface, being recognized by
              the end users that would be using the OP to authenticate.<a href="#section-3.2-4.4" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-4.5">federation_registration_endpoint</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-4.6">
              OPTIONAL.
              URL of the OP's Federation specific Dynamic Client Registration
              Endpoint. If the OP supports explicit client
              registration as described in <a href="#explicit" class="xref">Section 9.2</a>,
              then this claim is REQUIRED.<a href="#section-3.2-4.6" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-4.7">request_authentication_methods_supported</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-4.8">
            <p id="section-3.2-4.8.1">
              OPTIONAL.
              In OpenID Connect Core, no client authentication is performed at the authentication
              endpoint. Instead, you can say that a request authentication is
              performed. What it amounts to is that the OP maps
              the information in the request to the information it has
              on the client, through static or dynamic registration.
              If the map is successful, then the request is permitted to proceed.
              Something similar happens when automatic registration is used.
              Since there has been no explicit registration, the OP will gather
              information about the RP using the process outlined in
              <a href="#federation_configuration" class="xref">Section 5</a>. Once it has the RP
              metadata, the OP can verify the information the RP provides in the
              request. We make this a bit more secure by demanding the use of
              the request parameter or pushed authorization.<a href="#section-3.2-4.8.1" class="pilcrow">Â¶</a></p>
<p id="section-3.2-4.8.2">
              The claim value is a JSON object with members representing
              processes/endpoints and
              as values lists of request authentication methods that are
              supported by the authorization endpoint.
              In this specification we use the processes/endpoints:
              Authorization Request (AR) as described in Section 3 of
              <span><a href="#OpenID.Core" class="xref">OpenID Connect Core 1.0</a> [<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span>
              and
              Pushed Authorization Request (PAR), as described in
              <span>[<a href="#PAR" class="xref">PAR</a>]</span>.
              The request authentication methods are:<a href="#section-3.2-4.8.2" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.2-4.8.3">
              <dt id="section-3.2-4.8.3.1">request_object</dt>
              <dd style="margin-left: 1.5em" id="section-3.2-4.8.3.2">
                  This uses a Request Object as described in
                  <span><a href="#OpenID.Core" class="xref">OpenID Connect Core 1.0</a> [<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span>.
                  More about this in
                  <a href="#automatic" class="xref">Section 9.1</a>.<a href="#section-3.2-4.8.3.2" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2-4.8.3.3">private_key_jwt</dt>
              <dd style="margin-left: 1.5em" id="section-3.2-4.8.3.4">
                  The authentication process is described in Section 9 of
                  <span><a href="#OpenID.Core" class="xref">OpenID Connect Core 1.0</a> [<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span>.
                  Note that if <code>private_key_jwt</code> is
                  used, the audience of the signed JWT MUST be either the URL of
                  the Authorization Server's Authorization Endpoint or the
                  Authorization Server's entity identifier.<a href="#section-3.2-4.8.3.4" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2-4.8.3.5">tls_client_auth</dt>
              <dd style="margin-left: 1.5em" id="section-3.2-4.8.3.6">
                  Section 2.1 of
                  <span>[<a href="#RFC8705" class="xref">RFC8705</a>]</span>.<a href="#section-3.2-4.8.3.6" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.2-4.8.3.7">self_signed_tls_client_auth</dt>
              <dd style="margin-left: 1.5em" id="section-3.2-4.8.3.8">
                  Section 2.2 of
                  <span>[<a href="#RFC8705" class="xref">RFC8705</a>]</span>.<a href="#section-3.2-4.8.3.8" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-3.2-4.8.4">
              The only request authentication method that can be used if
              doing authentication as described in
              <span><a href="#OpenID.Core" class="xref">OpenID Connect Core 1.0</a> [<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span>
              is <code>request_object</code>.
              If pushed authorization is used then one of
              <code>private_key_jwt</code>,
              <code>tls_client_auth</code>
              and
              <code>self_signed_tls_client_auth</code>
              can be
              used.<a href="#section-3.2-4.8.4" class="pilcrow">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-4.9">signed_jwks_uri</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-4.10">
              OPTIONAL. A URI pointing to a signed JWT having the entity's
              JWKS as payload. The JWT is signed with a key that was included
              in the JWK that the entity published in its self-signed entity
              statement.<a href="#section-3.2-4.10" class="pilcrow">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.2-5">
          The following is a non-normative example of OP metadata:'<a href="#section-3.2-5" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.2-6">
<pre>
{
  "issuer": "https://server.example.com",
  "authorization_endpoint":
    "https://server.example.com/authorization",
  "token_endpoint": "https://server.example.com/token",
  "signed_jwks_uri": "https://server.example.com/jws.json",
  "response_types_supported": ["code", "id_token", "id_token token"],
  "subject_types_supported": ["public"],
  "id_token_signing_alg_values_supported": ["RS256", "ES256"],
  "token_endpoint_auth_methods_supported": ["private_key_jwt"],
  "pushed_authorization_request_endpoint":
    "https://server.example.com/par",
  "client_registration_types_supported": ["automatic", "explicit"],
  "federation_registration_endpoint":
    "https://server.example.com/fedreg",
  "request_authentication_methods_supported": {
    "ar": ["request_object"],
    "par": ["private_key_jwt", "self_signed_tls_client_auth"]
  }
}
</pre><a href="#section-3.2-6" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<section id="section-3.3">
        <h3 id="name-oauth-authorization-server">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-oauth-authorization-server" class="section-name selfRef">OAuth Authorization Server</a>
        </h3>
<p id="section-3.3-1">
          The metadata type identifier is
          <code>oauth_authorization_server</code>.<a href="#section-3.3-1" class="pilcrow">Â¶</a></p>
<p id="section-3.3-2">
          All parameters defined in Section 2 of
          <span><a href="#RFC8414" class="xref">RFC 8414</a> [<a href="#RFC8414" class="xref">RFC8414</a>]</span>
          are applicable.<a href="#section-3.3-2" class="pilcrow">Â¶</a></p>
</section>
<section id="section-3.4">
        <h3 id="name-oauth-client">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-oauth-client" class="section-name selfRef">OAuth Client</a>
        </h3>
<p id="section-3.4-1">
          The metadata type identifier is
          <code>oauth_client</code>.<a href="#section-3.4-1" class="pilcrow">Â¶</a></p>
<p id="section-3.4-2">
          All parameters defined in Section 2 of
          <span><a href="#RFC7591" class="xref">RFC 7591</a> [<a href="#RFC7591" class="xref">RFC7591</a>]</span>
          are applicable.<a href="#section-3.4-2" class="pilcrow">Â¶</a></p>
</section>
<section id="section-3.5">
        <h3 id="name-oauth-protected-resource">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-oauth-protected-resource" class="section-name selfRef">OAuth Protected Resource</a>
        </h3>
<p id="section-3.5-1">
          The metadata type identifier is
          <code>oauth_resource</code>.
          There is no standard that specifies what parameters can occur
          in the metadata for this kind of entity. So for the time being, this
          can be regarded as a placeholder.<a href="#section-3.5-1" class="pilcrow">Â¶</a></p>
</section>
<section id="section-3.6">
        <h3 id="name-federation-entity">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-federation-entity" class="section-name selfRef">Federation Entity</a>
        </h3>
<p id="section-3.6-1">
          The metadata type identifier is
          <code>federation_entity</code>.<a href="#section-3.6-1" class="pilcrow">Â¶</a></p>
<p id="section-3.6-2">
          All entities participating in a federation are of this type.<a href="#section-3.6-2" class="pilcrow">Â¶</a></p>
<p id="section-3.6-3">
          The following properties are allowed:<a href="#section-3.6-3" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.6-4">
          <dt id="section-3.6-4.1">federation_api_endpoint</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-4.2">
              OPTIONAL.
              The endpoint for the Federation API described in
              <a href="#federation_api" class="xref">Section 6</a>. Intermediate entities and
              trust anchors MUST publish a
       <code>federation_api_endpoint</code>.
              Leaf entities MUST NOT.<a href="#section-3.6-4.2" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-4.3">name</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-4.4">
              OPTIONAL. String. The human-readable name
              describing the subject entity. This may be, for example, the
              name of an organization.<a href="#section-3.6-4.4" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-4.5">contacts</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-4.6">
              OPTIONAL. JSON array with one or more
              strings representing contact persons at the entity.
              These may contain names, e-mail addresses, descriptions, phone
              numbers, etc.<a href="#section-3.6-4.6" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-4.7">policy_uri</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-4.8">
              OPTIONAL. URL to documentation of
              conditions and policies relevant to this entity.<a href="#section-3.6-4.8" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-4.9">homepage_uri</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-4.10">
              OPTIONAL. URL to a generic home page
              representing this entity.<a href="#section-3.6-4.10" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-4.11">trust_marks</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-4.12">
              OPTIONAL. A JSON array of signed JSON Web Token each representing
              a certification mark. More about certification marks in
              <a href="#trust_marks" class="xref">Section 4.3</a><a href="#section-3.6-4.12" class="pilcrow">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.6-5">Example<a href="#section-3.6-5" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.6-6">
<pre>
"federation_entity": {
  "federation_api_endpoint":
    "https://example.com/federation_api_endpoint",
  "name": "The example cooperation",
  "homepage_uri": "https://www.example.com"
}
</pre><a href="#section-3.6-6" class="pilcrow">Â¶</a>
</div>
</section>
</section>
</div>
<div id="federation_policy">
<section id="section-4">
      <h2 id="name-federation-policy">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-federation-policy" class="section-name selfRef">Federation Policy</a>
      </h2>
<div id="metadata_policy">
<section id="section-4.1">
        <h3 id="name-metadata-policy">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-metadata-policy" class="section-name selfRef">Metadata Policy</a>
        </h3>
<p id="section-4.1-1">
          An entity can publish metadata policies pertaining to entities of a
          specific type. Entity type identifiers specified in this document
          can be found in <a href="#metadata" class="xref">Section 3</a>.<a href="#section-4.1-1" class="pilcrow">Â¶</a></p>
<p id="section-4.1-2">
          Each such metadata policy has the following structure:<a href="#section-4.1-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-3.1">It consists of one or more policy entries.<a href="#section-4.1-3.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-4.1-3.2">Each policy entry applies to one metadata parameter, such as
              <code>id_token_signing_alg</code>.<a href="#section-4.1-3.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-4.1-3.3">Each policy entry consists of one or more operators, which can be
              value modifiers or value checks.<a href="#section-4.1-3.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-4.1-3.4">An operator can only appear once in a policy entry.<a href="#section-4.1-3.4" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-4.1-4">
          It should be noted that claim names without language tags are different
          from the same claim but with language tags.<a href="#section-4.1-4" class="pilcrow">Â¶</a></p>
<p id="section-4.1-5" class="keepWithNext">
              An example of a policy entry:<a href="#section-4.1-5" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-6">
<pre>
"id_token_signing_alg": {
  "default": "ES256",
  "one_of" : ["ES256", "ES384", "ES512"]
}
</pre><a href="#section-4.1-6" class="pilcrow">Â¶</a>
</div>
<p id="section-4.1-7" class="keepWithNext">
              Which fits into a metadata policy like this:<a href="#section-4.1-7" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-8">
<pre>
"metadata_policy" : {
  "openid_relying_party": {
    "id_token_signing_alg": {
      "default": "ES256",
      "one_of" : ["ES256", "ES384", "ES512"]
    }
  }
}
</pre><a href="#section-4.1-8" class="pilcrow">Â¶</a>
</div>
<section id="section-4.1.1">
          <h4 id="name-operators">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-operators" class="section-name selfRef">Operators</a>
          </h4>
<p id="section-4.1.1-1">
            Value modifiers are:<a href="#section-4.1.1-1" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.1.1-2">
            <dt id="section-4.1.1-2.1">value</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-2.2">
                Disregarding what value the parameter had, if any, the
                parameter's
                value
                will be set to the operator's value.<a href="#section-4.1.1-2.2" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-2.3">add</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-2.4">
                Adds the value or values specified to the metadata parameter.
                If any of the specified values are already present
                as values of the parameter, they will not be added.
                If the parameter has no value,
                then the parameter is initialized with the specified value(s).<a href="#section-4.1.1-2.4" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-2.5">default</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-2.6">
                If no value is assigned to this parameter, then the parameter's
                value
                will be set to the operator's value(s).<a href="#section-4.1.1-2.6" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.1.1-3">
            Value checks are:<a href="#section-4.1.1-3" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.1.1-4">
            <dt id="section-4.1.1-4.1">one_of</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-4.2">
                The value of the parameter MUST be one of the ones listed in
                this
                directive.<a href="#section-4.1.1-4.2" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-4.3">subset_of</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-4.4">
                The resulting value of the parameter will be the intersection of
                the
                values in the directive and the values of the parameter.<a href="#section-4.1.1-4.4" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-4.5">superset_of</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-4.6">
                The values of the parameter MUST contain the ones in the
                directive.
                We define superset the mathematical way, that is, equality is
                included.<a href="#section-4.1.1-4.6" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-4.7">essential</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-4.8">
                If <code>true</code>, then the parameter MUST have a value.<a href="#section-4.1.1-4.8" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<div id="policy_restr">
<section id="section-4.1.2">
          <h4 id="name-restrictions-on-policy-entr">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-restrictions-on-policy-entr" class="section-name selfRef">Restrictions on Policy Entries</a>
          </h4>
<p id="section-4.1.2-1">
            As stated, a policy entry can contain one or more operators.
            Not all operators are allowed to appear together in a policy entry.<a href="#section-4.1.2-1" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.1.2-2">
            <dt id="section-4.1.2-2.1">subset_of/superset_of and one_of</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.2-2.2">
              <code>subset_of</code>
                and
                <code>superset_of</code>
                applies to parameters
                that can have more than
                one value (for instance, <code>contacts</code>)
                while <code>one_of</code> applies to
                parameters that can only have one value (for instance,
                <code>id_token_signed_response_alg</code>).
                This means that <code>one_of</code> cannot
                appear beside
                <code>subset_of</code>/
                <code>superset_of</code>
                in a
                policy entry.<a href="#section-4.1.2-2.2" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.2-2.3">value</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.2-2.4">
              <code>value</code>
                overrides everything else.
                So having <code>value</code> together with any
                other operator (except for
                <code>essential</code>) does not make sense.<a href="#section-4.1.2-2.4" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.1.2-3">
            Other restrictions are:<a href="#section-4.1.2-3" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.2-4.1">
                If <code>subset_of</code> and
                <code>superset_of</code>
                both appears as
                operators then the
                list of values in
                <code>subset_of</code>
                MUST be a superset of the values in
                <code>superset_of</code>.<a href="#section-4.1.2-4.1" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-4.1.2-4.2">
                If <code>add</code> appears in a policy entry
                together with
                <code>subset_of</code>
                then the value/values of <code>add</code> MUST
                be a subset of <code>subset_of</code>.<a href="#section-4.1.2-4.2" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-4.1.2-4.3">
                If <code>add</code> appears in a policy entry
                together with
                <code>superset_of</code>
                then
                the values of <code>add</code> MUST be a
                superset of <code>superset_of</code>.<a href="#section-4.1.2-4.3" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-4.1.2-4.4">
                If <code>default</code> appears in a policy
                entry together with
                <code>subset_of</code>
                then
                the values of <code>default</code> MUST be a
                subset of <code>subset_of</code>.<a href="#section-4.1.2-4.4" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-4.1.2-4.5">
                If <code>default</code> appears in a policy entry
                together with
                <code>superset_of</code>
                then the values of <code>default</code> MUST be a
                superset of
                <code>superset_of</code>.<a href="#section-4.1.2-4.5" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-4.1.2-4.6">
                If <code>add</code> appears in a policy entry
                together with <code>one_of</code> then
                the
                value of <code>add</code> MUST be a member
                of <code>one_of</code>.<a href="#section-4.1.2-4.6" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-4.1.2-4.7">
                If <code>default</code> appears in a policy entry
                together with
                <code>one_of</code>
                then the
                value <code>default</code> MUST be a member
                of <code>one_of</code>.<a href="#section-4.1.2-4.7" class="pilcrow">Â¶</a>
</li>
          </ul>
</section>
</div>
<section id="section-4.1.3">
          <h4 id="name-combining-policies">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-combining-policies" class="section-name selfRef">Combining Policies</a>
          </h4>
<p id="section-4.1.3-1">
            If there is more than one metadata policy in a trust chain, then the
            policies
            MUST be combined before they are applied to the metadata statement.<a href="#section-4.1.3-1" class="pilcrow">Â¶</a></p>
<p id="section-4.1.3-2">
            Using the notation we have defined in <a href="#trust_chain" class="xref">Section 2.2</a>, policies are
            combined
            starting with ES[i] and then adding the policies from ES[j]
            j=i-1,..,1
            before applying the combined policy to the entity's metadata.<a href="#section-4.1.3-2" class="pilcrow">Â¶</a></p>
<p id="section-4.1.3-3">
            After each combination, the policy for each parameter MUST
            adhere to the rules defined in <a href="#policy_restr" class="xref">Section 4.1.2</a>.<a href="#section-4.1.3-3" class="pilcrow">Â¶</a></p>
<section id="section-4.1.3.1">
            <h5 id="name-merging-operators">
<a href="#section-4.1.3.1" class="section-number selfRef">4.1.3.1. </a><a href="#name-merging-operators" class="section-name selfRef">Merging Operators</a>
            </h5>
<span class="break"></span><dl class="dlNewline" id="section-4.1.3.1-1">
              <dt id="section-4.1.3.1-1.1">subset_of</dt>
              <dd style="margin-left: 1.5em" id="section-4.1.3.1-1.2">
                  The result of merging the values of two
                  <code>subset_of</code> operators is the
                  intersection of the operator values.<a href="#section-4.1.3.1-1.2" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.1.3.1-1.3">one_of</dt>
              <dd style="margin-left: 1.5em" id="section-4.1.3.1-1.4">
                  The result of merging the values of two
                  <code>one_of</code> operators is the
                  intersection of the operator values.<a href="#section-4.1.3.1-1.4" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.1.3.1-1.5">superset_of</dt>
              <dd style="margin-left: 1.5em" id="section-4.1.3.1-1.6">
                  The result of merging the values of two
                  <code>superset_of</code> operators is the
                  union of the operator values.<a href="#section-4.1.3.1-1.6" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.1.3.1-1.7">add</dt>
              <dd style="margin-left: 1.5em" id="section-4.1.3.1-1.8">
                  The result of merging the values of two
                  <code>add</code>
                  operators is the union of the values.<a href="#section-4.1.3.1-1.8" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.1.3.1-1.9">value</dt>
              <dd style="margin-left: 1.5em" id="section-4.1.3.1-1.10">
                  Merging two <code>value</code> operators is
                  NOT allowed unless the two operator values are equal.<a href="#section-4.1.3.1-1.10" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.1.3.1-1.11">default</dt>
              <dd style="margin-left: 1.5em" id="section-4.1.3.1-1.12">
                  Merging two <code>default</code> operators is
                  NOT allowed unless the two operator values are equal.<a href="#section-4.1.3.1-1.12" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.1.3.1-1.13">essential</dt>
              <dd style="margin-left: 1.5em" id="section-4.1.3.1-1.14">
                  If a superior has specified <code>essential=true</code>,
   then a subordinate
                  cannot change that. If a superior has specified
                  <code>essential=false</code>, then a
                  subordinate is allowed to change that to
   <code>essential=true</code>.
                  If a superior has not specified
                  <code>essential</code>, then a subordinate
                  can set <code>essential</code> to
   <code>true</code> or <code>false</code>.<a href="#section-4.1.3.1-1.14" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</section>
<section id="section-4.1.4">
          <h4 id="name-applying-policies">
<a href="#section-4.1.4" class="section-number selfRef">4.1.4. </a><a href="#name-applying-policies" class="section-name selfRef">Applying Policies</a>
          </h4>
<p id="section-4.1.4-1">
            Once combining the Metadata policies has been accomplished, the next
            step is to apply the combined policy to the metadata.<a href="#section-4.1.4-1" class="pilcrow">Â¶</a></p>
<p id="section-4.1.4-2">
            Doing that, one follows these steps for each parameter in the
            policy.<a href="#section-4.1.4-2" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1.4-3">
<li id="section-4.1.4-3.1">
                If there is a <code>value</code> operator in the
                policy, apply that and you are done.<a href="#section-4.1.4-3.1" class="pilcrow">Â¶</a>
</li>
            <li id="section-4.1.4-3.2">
                Add whatever value is specified in an <code>add</code>
 operator.<a href="#section-4.1.4-3.2" class="pilcrow">Â¶</a>
</li>
            <li id="section-4.1.4-3.3">
                If the parameter still has no value apply the
 <code>default</code> if there is one.<a href="#section-4.1.4-3.3" class="pilcrow">Â¶</a>
</li>
            <li id="section-4.1.4-3.4">
                Do the essential check. If <code>essential</code> is
                missing as an operator
                <code>essential</code>
                is to be treated as if set to <code>false</code>.
                If <code>essential</code> is defined to be
 <code>true</code>,
                then the claim
                MUST have a value by now. Otherwise applying the operator MUST
                fail.<a href="#section-4.1.4-3.4" class="pilcrow">Â¶</a>
</li>
            <li id="section-4.1.4-3.5">
                Do the other checks. Verified that the value is
 <code>one_of</code> or that the
                values are <code>subset_of</code>/<code>superset_of</code>. If the parameter values
                do not fall within the allowed boundaries,
 applying the operator MUST fail.<a href="#section-4.1.4-3.5" class="pilcrow">Â¶</a>
</li>
          </ol>
</section>
<section id="section-4.1.5">
          <h4 id="name-policy-combination-example">
<a href="#section-4.1.5" class="section-number selfRef">4.1.5. </a><a href="#name-policy-combination-example" class="section-name selfRef">Policy Combination Example</a>
          </h4>
<p id="section-4.1.5-1" class="keepWithNext">
              A federation's policy for RPs:<a href="#section-4.1.5-1" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.5-2">
<pre>
{
  "scopes": {
    "subset_of": [
      "openid",
      "eduperson",
      "phone"
    ],
    "superset_of": [
      "openid"
    ],
    "default": [
      "openid",
      "eduperson"
    ]
  },
  "id_token_signed_response_alg": {
    "one_of": [
      "ES256",
      "ES384",
      "ES512"
    ]
  },
  "contacts": {
    "add": "helpdesk@federation.example.org"
  },
  "application_type": {
    "value": "web"
  }
}
</pre><a href="#section-4.1.5-2" class="pilcrow">Â¶</a>
</div>
<p id="section-4.1.5-3" class="keepWithNext">
              An organization's policy for RPs:<a href="#section-4.1.5-3" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.5-4">
<pre>
{
  "scopes": {
    "subset_of": [
      "openid",
      "eduperson",
      "address"
    ],
    "default": [
      "openid",
      "eduperson"
    ]
  },
  "id_token_signed_response_alg": {
    "one_of": [
      "ES256",
      "ES384"
    ],
    "default": "ES256"
  },
  "contacts": {
    "add": "helpdesk@org.example.org"
  }
}
</pre><a href="#section-4.1.5-4" class="pilcrow">Â¶</a>
</div>
<p id="section-4.1.5-5" class="keepWithNext">
              The combined metadata policy then becomes:<a href="#section-4.1.5-5" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.5-6">
<pre>
{
  "scopes": {
    "subset_of": [
      "openid",
      "eduperson"
    ],
    "superset_of": [
      "openid"
    ],
    "default": [
      "openid",
      "eduperson"
    ]
  },
  "id_token_signed_response_alg": {
    "one_of": [
      "ES256",
      "ES384"
    ],
    "default": "ES256"
  },
  "contacts": {
    "add": [
      "helpdesk@federation.example.org",
      "helpdesk@org.example.org"
    ]
  },
  "application_type": {
    "value": "web"
  }
}
</pre><a href="#section-4.1.5-6" class="pilcrow">Â¶</a>
</div>
</section>
<section id="section-4.1.6">
          <h4 id="name-enforcing-policy">
<a href="#section-4.1.6" class="section-number selfRef">4.1.6. </a><a href="#name-enforcing-policy" class="section-name selfRef">Enforcing Policy</a>
          </h4>
<p id="section-4.1.6-1">
          If applying policies to a metadata statement results in incorrect
          metadata, then such a metadata statement MUST
          be regarded as broken and MUST NOT be used.<a href="#section-4.1.6-1" class="pilcrow">Â¶</a></p>
</section>
<section id="section-4.1.7">
          <h4 id="name-extending-the-policy-langua">
<a href="#section-4.1.7" class="section-number selfRef">4.1.7. </a><a href="#name-extending-the-policy-langua" class="section-name selfRef">Extending the Policy Language</a>
          </h4>
<p id="section-4.1.7-1">
          There might be parties that want to extend the policy language
          defined here. If that happens then the rule is that if
          software compliant with this specification
          encounters a keyword it does not understand,
   it MUST ignore it
          unless it is listed in a
          <code>policy_language_crit</code>
          list,
          as is done for <span><a href="#RFC7515" class="xref">JWS</a> [<a href="#RFC7515" class="xref">RFC7515</a>]</span> header parameters
          with the <code>crit</code> parameter.
          If the policy language extension keyword
          is listed in the <code>policy_language_crit</code> list
          and not understood, then the metadata MUST be rejected.<a href="#section-4.1.7-1" class="pilcrow">Â¶</a></p>
</section>
<section id="section-4.1.8">
          <h4 id="name-policy-example">
<a href="#section-4.1.8" class="section-number selfRef">4.1.8. </a><a href="#name-policy-example" class="section-name selfRef">Policy Example</a>
          </h4>
<p id="section-4.1.8-1">
          The following is a non-normative example of a set of policies being
          applied to an RP's metadata.<a href="#section-4.1.8-1" class="pilcrow">Â¶</a></p>
<p id="section-4.1.8-2" class="keepWithNext">
            The RP's metadata:<a href="#section-4.1.8-2" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.8-3">
<pre>
{
  "contacts": [
    "rp_admins@cs.example.com"
  ],
  "redirect_uris": [
    "https://cs.example.com/rp1"
  ],
  "response_types": [
    "code"
  ]
}
</pre><a href="#section-4.1.8-3" class="pilcrow">Â¶</a>
</div>
<p id="section-4.1.8-4" class="keepWithNext">
            The federation's policy for RPs:<a href="#section-4.1.8-4" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.8-5">
<pre>
{
  "scopes": {
    "superset_of": [
      "openid",
      "eduperson"
    ],
    "default": [
      "openid",
      "eduperson"
    ]
  },
  "response_types": {
    "subset_of": [
      "code",
      "code id_token"
    ]
  }
}
</pre><a href="#section-4.1.8-5" class="pilcrow">Â¶</a>
</div>
<p id="section-4.1.8-6" class="keepWithNext">
            The organization's policy for RPs:<a href="#section-4.1.8-6" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.8-7">
<pre>
{
  "contacts": {
    "add": "helpdesk@example.com"
  },
  "logo_uri": {
    "one_of": [
      "https://example.com/logo_small.jpg",
      "https://example.com/logo_big.jpg"
    ],
    "default": "https://example.com/logo_small.jpg"
  },
  "policy_uri": {
    "value": "https://example.com/policy.html"
  },
  "tos_uri": {
    "value": "https://example.com/tos.html"
  }
}
</pre><a href="#section-4.1.8-7" class="pilcrow">Â¶</a>
</div>
<p id="section-4.1.8-8">
          The metadata for the entity in question,
   after applying the policies above,
   would then become:<a href="#section-4.1.8-8" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.8-9">
<pre>
{
  "contacts": [
    "rp_admins@cs.example.com",
    "helpdesk@example.com"
  ],
  "logo_uri": "https://example.com/logo_small.jpg",
  "policy_uri": "https://example.com/policy.html",
  "tos_uri": "https://example.com/tos.html",
  "scopes": [
    "openid",
    "eduperson"
  ],
  "response_types": [
    "code"
  ],
  "redirect_uris": [
    "https://cs.example.com/rp1"
  ]
}
</pre><a href="#section-4.1.8-9" class="pilcrow">Â¶</a>
</div>
</section>
</section>
</div>
<div id="chain_constraints">
<section id="section-4.2">
        <h3 id="name-applying-constraints">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-applying-constraints" class="section-name selfRef">Applying Constraints</a>
        </h3>
<p id="section-4.2-1">A constraint specification can contain the following claims:<a href="#section-4.2-1" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-2">
          <dt id="section-4.2-2.1">max_path_length</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-2.2">
              OPTIONAL. Integer. The maximum number of entity statements
              between this entity statement and the last entity statement in
              the trust chain.<a href="#section-4.2-2.2" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-2.3">naming_constraints</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-2.4">
              OPTIONAL. JSON object. Restriction on the entity identifiers of
              the
              entities below this entity. The behavior of this claim mimics
              what is defined in Section 4.2.1.10 in <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>.
              Restrictions are defined in terms of permitted or excluded name
              subtrees.<a href="#section-4.2-2.4" class="pilcrow">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-3">The following is a non-normative example of such a specification:<a href="#section-4.2-3" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.2-4">
<pre>
{
  "naming_constraints": {
    "permitted": [
      "https://.example.com"
    ],
    "excluded": [
      "https://east.example.com"
    ]
  },
  "max_path_length": 2
}
</pre><a href="#section-4.2-4" class="pilcrow">Â¶</a>
</div>
<p id="section-4.2-5">
          If a subordinate entity statement contains a constraint specification
          that is more restrictive than the one in effect, then the more
          restrictive constraint is in effect from here on.<a href="#section-4.2-5" class="pilcrow">Â¶</a></p>
<p id="section-4.2-6">
          If a subordinate entity statement contains a constraint specification
          that is less restrictive than the one in effect, then it MUST be
          ignored.<a href="#section-4.2-6" class="pilcrow">Â¶</a></p>
<div id="max_path_length">
<section id="section-4.2.1">
          <h4 id="name-max-path-length">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-max-path-length" class="section-name selfRef">Max Path Length</a>
          </h4>
<p id="section-4.2.1-1">
            The <code>max_path_length</code> constraint specifies
            the
            maximum number of
            entity statement a trust chain can have between the entity statement
            that contains the constraint specification and the leaf's entity
            statement.<a href="#section-4.2.1-1" class="pilcrow">Â¶</a></p>
<p id="section-4.2.1-2">
            A <code>max_path_length</code> constraint of zero
            indicates that no
            entity statement may appear between this entity statement and the
            leaf entity statement. Where it appears, the
     <code>max_path_length</code> constraint
            MUST have a value that is greater than or equal to zero.
            Where <code>max_path_length</code> does not appear,
            no
            limit is imposed.<a href="#section-4.2.1-2" class="pilcrow">Â¶</a></p>
<p id="section-4.2.1-3">
            Assuming that we have a trust chain with four entity statements:<a href="#section-4.2.1-3" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.1-4">
<li id="section-4.2.1-4.1">Leaf entity (LE)<a href="#section-4.2.1-4.1" class="pilcrow">Â¶</a>
</li>
            <li id="section-4.2.1-4.2">Intermediate 1 (I1)<a href="#section-4.2.1-4.2" class="pilcrow">Â¶</a>
</li>
            <li id="section-4.2.1-4.3">Intermediate 2 (I2)<a href="#section-4.2.1-4.3" class="pilcrow">Â¶</a>
</li>
            <li id="section-4.2.1-4.4">Trust Anchor (TA)<a href="#section-4.2.1-4.4" class="pilcrow">Â¶</a>
</li>
          </ol>
<p id="section-4.2.1-5">
            Then the trust chain fulfills the constraints if:<a href="#section-4.2.1-5" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-6.1">
                The TA specifies a <code>max_path_length</code> that
                is equal to or bigger
                than 2.<a href="#section-4.2.1-6.1" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-4.2.1-6.2">
                TA specifies <code>max_path_length</code> of 2,
                I2
                specifies <code>max_path_length</code> of 1,
                and I1 specifies no <code>max_path_length</code> constraint.<a href="#section-4.2.1-6.2" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-4.2.1-6.3">Neither TA nor I2 specifies any
         <code>max_path_length</code> constraint
                while I1 specifies <code>max_path_length</code> of
                0.<a href="#section-4.2.1-6.3" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="section-4.2.1-7">
            The trust chain does not fulfill the constraints if:<a href="#section-4.2.1-7" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-8.1">TA has specified <code>max_path_length</code> of
                1.<a href="#section-4.2.1-8.1" class="pilcrow">Â¶</a>
</li>
          </ul>
</section>
</div>
<div id="naming_constraints">
<section id="section-4.2.2">
          <h4 id="name-naming-constraints">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-naming-constraints" class="section-name selfRef">Naming Constraints</a>
          </h4>
<p id="section-4.2.2-1">
            The <code>naming_constraints</code> member
     specifies a namespace within which all subject
            entity identifiers in subordinate entity statements in a trust chain
            MUST be located.<a href="#section-4.2.2-1" class="pilcrow">Â¶</a></p>
<p id="section-4.2.2-2">
            Restrictions are defined in terms of permitted or excluded name
            subtrees. Any name matching a restriction in the excluded
            claim is invalid regardless of information appearing in the
            permitted claim.<a href="#section-4.2.2-2" class="pilcrow">Â¶</a></p>
<p id="section-4.2.2-3">
            The constraint MUST be specified as a fully qualified domain name
            and MAY specify a host or a domain. Examples would be
            "host.example.com" and ".example.com". When the constraint begins
            with a period, it MAY be expanded with one or more labels.
            That is, the constraint ".example.com" is satisfied by both
            host.example.com and my.host.example.com. However, the constraint
            ".example.com" is not satisfied by "example.com". When the
            constraint does not begin with a period, it specifies a host.<a href="#section-4.2.2-3" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="trust_marks">
<section id="section-4.3">
        <h3 id="name-trust-marks">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-trust-marks" class="section-name selfRef">Trust Marks</a>
        </h3>
<p id="section-4.3-1">
   In this specification we use the US NSTIC definition:
          "A trustmark is used to indicate that a product or service provider
          has met the requirements of the Identity Ecosystem, as determined
          by an accreditation authority".<a href="#section-4.3-1" class="pilcrow">Â¶</a></p>
<p id="section-4.3-2">
   Technically, trust marks as used by this specification are signed
          JWTs that represent a statement of conformance to a well-scoped
          set of trust and/or interoperability requirements.<a href="#section-4.3-2" class="pilcrow">Â¶</a></p>
<p id="section-4.3-3">
   The trust marks are signed by a federation accredited
          authority. The validation of such a signed statement is performed
          in the same way that a self-signed entity statement is validated.<a href="#section-4.3-3" class="pilcrow">Â¶</a></p>
<p id="section-4.3-4">
   Note that a federation may allow an entity to self-sign
          some trust marks.<a href="#section-4.3-4" class="pilcrow">Â¶</a></p>
<div id="trust_prop">
<section id="section-4.3.1">
          <h4 id="name-trust-mark-properties">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-trust-mark-properties" class="section-name selfRef">Trust Mark Properties</a>
          </h4>
<p id="section-4.3.1-1">These are the properties that can occur in a trust mark:<a href="#section-4.3.1-1" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.3.1-2">
            <dt id="section-4.3.1-2.1">iss</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.1-2.2">
                REQUIRED. String. The issuer of the trust mark.<a href="#section-4.3.1-2.2" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-2.3">sub</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.1-2.4">
                REQUIRED. String. The entity this trust mark applies to.<a href="#section-4.3.1-2.4" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-2.5">id</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.1-2.6">
                REQUIRED. String. An identifier of the trust mark.<a href="#section-4.3.1-2.6" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-2.7">iat</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.1-2.8">
                REQUIRED. Number. When this trust mark was issued.
 Expressed as Seconds Since the Epoch, per <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span>.<a href="#section-4.3.1-2.8" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-2.9">mark</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.1-2.10">
                OPTIONAL. String. An URL that points to a mark/logo that the
                subject is allowed to display to a user of the entity.<a href="#section-4.3.1-2.10" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-2.11">exp</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.1-2.12">
                OPTIONAL. Number. When this trust mark is not valid anymore.
                Expressed as Seconds Since the Epoch, per <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span>.
 If not present, it means that
                the trust mark is valid forever.<a href="#section-4.3.1-2.12" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-2.13">ref</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.1-2.14">
                OPTIONAL. String. URL that points to information connected to
                the issuance of this trust mark.<a href="#section-4.3.1-2.14" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="trust_valid">
<section id="section-4.3.2">
          <h4 id="name-validating-a-trust-mark">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-validating-a-trust-mark" class="section-name selfRef">Validating a Trust Mark</a>
          </h4>
<p id="section-4.3.2-1">An entity should not try to validate a trust mark until
            it knows which trust anchors it wants to use.<a href="#section-4.3.2-1" class="pilcrow">Â¶</a></p>
<p id="section-4.3.2-2">validating a trust mark follows the procedure set out in
            <a href="#resolving_trust" class="xref">Section 7</a><a href="#section-4.3.2-2" class="pilcrow">Â¶</a></p>
<p id="section-4.3.2-3">Note that the entity representing the accreditation authority
            MUST be immediately below the trust anchor. There cannot be any
            intermediate between it and the trust anchor.<a href="#section-4.3.2-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="trust_example">
<section id="section-4.3.3">
          <h4 id="name-trust-mark-example">
<a href="#section-4.3.3" class="section-number selfRef">4.3.3. </a><a href="#name-trust-mark-example" class="section-name selfRef">Trust Mark Example</a>
          </h4>
<p id="section-4.3.3-1" class="keepWithNext">An example of a self-signed certification mark:<a href="#section-4.3.3-1" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3.3-2">
<pre>
{
  "iss": "https://example.com/op",
  "sub": "https://example.com/op",
  "iat": 1579621160,
  "id": "https://openid.net/certification/op",
  "mark": "http://openid.net/wordpress-content/uploads/2016/
    05/oid-l-certification-mark-l-cmyk-150dpi-90mm.jpg",
  "ref": "https://openid.net/wordpress-content/uploads/2015/
    09/RolandHedberg-pyoidc-0.7.7-Basic-26-Sept-2015.zip"
}
</pre><a href="#section-4.3.3-2" class="pilcrow">Â¶</a>
</div>
<p id="section-4.3.3-3" class="keepWithNext">An example of a third-party accreditation authority:<a href="#section-4.3.3-3" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3.3-4">
<pre>
{
  "iss": "https://swamid.sunet.se",
  "sub": "https://umu.se/op",
  "iat": 1577833200,
  "exp": 1609369200,
  "id":
    "https://refeds.org/wp-content/uploads/2016/01/Sirtfi-1.0.pdf"
}
</pre><a href="#section-4.3.3-4" class="pilcrow">Â¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="federation_configuration">
<section id="section-5">
      <h2 id="name-obtaining-federation-entity">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-obtaining-federation-entity" class="section-name selfRef">Obtaining Federation Entity Configuration Information</a>
      </h2>
<p id="section-5-1">
        The configuration endpoint is found using the
        <span><a href="#RFC8615" class="xref">Well-Known URIs</a> [<a href="#RFC8615" class="xref">RFC8615</a>]</span>
        specification, with the suffix
        <code>openid-federation</code>. The scheme, host, and port
        are taken directly from the entity identifier combined with the following
        path: <code>/.well-known/openid-federation</code>.<a href="#section-5-1" class="pilcrow">Â¶</a></p>
<p id="section-5-2">
        If the entity identifier contains a path, it is concatenated after
        <code>/.well-known/openid-federation</code>
        in the same
        manner
        that path components are concatenated to the well-known identifier in
        the OAuth 2.0 Authorization Server Metadata
        <span>[<a href="#RFC8414" class="xref">RFC8414</a>]</span>
        specification.
        Of course, in real multi-tenant deployments, in which the entity
        identifier
        might be of the form
        <code>https://multi-tenant-service.example.com/my-tenant-identifier</code>
        the tenant is very likely to not have control over the path
        <code>https://multi-tenant-service.example.com/.well-known/openid-federation/my-tenant-identifier</code>
        whereas it is very likely to have control over the path
        <code>https://multi-tenant-service.example.com/my-tenant-identifier/.well-known/openid-federation</code>.
        Therefore, if using the configuration endpoint at the URL with the
        tenant path
        after the well-known part fails,
        it is RECOMMENDED that callers retry at the URL with the tenant path
        before the well-known part
        (even though this violates <span>[<a href="#RFC8615" class="xref">RFC8615</a>]</span>).<a href="#section-5-2" class="pilcrow">Â¶</a></p>
<p id="section-5-3">
        Federation Entities SHOULD make an Entity Configuration Document
        available
        at the configuration endpoint. There is only one exception to this
        rule and that is for an RP that only does explicit registration. Since
        it
        posts the self-signed entity statement to the OP during client
        registration, the OP has everything it needs from the RP.<a href="#section-5-3" class="pilcrow">Â¶</a></p>
<section id="section-5.1">
        <h3 id="name-federation-entity-configura">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-federation-entity-configura" class="section-name selfRef">Federation Entity Configuration Request</a>
        </h3>
<p id="section-5.1-1">
          A federation Entity Configuration Document MUST be queried using an
          HTTP GET request at the previously specified path.
          The requesting party would make the following request to the Entity
          <code>https://example.com</code>
          to obtain its
          Configuration information:<a href="#section-5.1-1" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1-2">
<pre>

  GET /.well-known/openid-federation HTTP/1.1
  Host: example.com
</pre><a href="#section-5.1-2" class="pilcrow">Â¶</a>
</div>
</section>
<section id="section-5.2">
        <h3 id="name-federation-entity-configurat">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-federation-entity-configurat" class="section-name selfRef">Federation Entity Configuration Response</a>
        </h3>
<p id="section-5.2-1">The response is a self-signed Entity Statement, as described in
          <a href="#entity-statement" class="xref">Section 2.1</a>.
          If the entity is an intermediate entity or a trust anchor, the
          response MUST contain metadata for a federation entity.<a href="#section-5.2-1" class="pilcrow">Â¶</a></p>
<p id="section-5.2-2">
          A positive response is a signed entity statement, where the content
          type MUST be set to <code>application/jose</code>.
          In case of an error, the response
          will be a JSON object, the content type MUST be set to
          <code>application/json</code>
          and
          the error response uses the applicable HTTP status code value.<a href="#section-5.2-2" class="pilcrow">Â¶</a></p>
<p id="section-5.2-3">The following is a non-normative example response from an
          intermediate entity, before serialization and adding a signature:<a href="#section-5.2-3" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.2-4">
<pre>
200 OK
Last-Modified: Thu, 29 Aug 2019 08:54:26 GMT
Content-Type: application/jose

{
  "iss": "https://example.com",
  "sub": "https://example.com",
  "iat": 1516239022,
  "exp": 1516298022,
  "metadata": {
    "federation_entity": {
      "federation_api_endpoint":
        "https://example.com/federation_api_endpoint",
      "name": "The example cooperation",
      "homepage_uri": "https://www.example.com"
    }
  },
  "authority_hints": ["https://federation.example.com"],
  "jwks": {
    "keys": [
      {
        "alg": "RS256",
        "e": "AQAB",
        "key_ops": [
          "verify"
        ],
        "kid": "key1",
        "kty": "RSA",
        "n": "pnXBOusEANuug6ewezb9J_...",
        "use": "sig"
      }
    ]
  }
}
</pre><a href="#section-5.2-4" class="pilcrow">Â¶</a>
</div>
</section>
</section>
</div>
<div id="federation_api">
<section id="section-6">
      <h2 id="name-federation-api">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-federation-api" class="section-name selfRef">Federation API</a>
      </h2>
<p id="section-6-1">
        All entities that are expected to publish entity statements about other
        entities MUST expose a Federation API endpoint.<a href="#section-6-1" class="pilcrow">Â¶</a></p>
<p id="section-6-2">
        The federation API endpoint of an entity can be found in the
        configuration response as described in
        <a href="#federation_configuration" class="xref">Section 5</a>
        or by other means.<a href="#section-6-2" class="pilcrow">Â¶</a></p>
<p id="section-6-3">
        The Federation API is a HTTPS API that may support multiple
        operations. Fetching entity statements is one of the operations, and the
        only one that all Federation API endpoints are REQUIRED to support.
        All the other operations are OPTIONAL. The list of defined
        operations may be extended in the future.<a href="#section-6-3" class="pilcrow">Â¶</a></p>
<p id="section-6-4">
        While all operations on the federation API endpoint make use of a
        GET request, other operations may choose to use other HTTP methods. If
        the
        <code>operation</code>
        parameter is left out, it is treated as a
        fetch entity statements request. Unless otherwise mentioned or agreed
        upon, requests to the federation API do not need to be
        authenticated.<a href="#section-6-4" class="pilcrow">Â¶</a></p>
<section id="section-6.1">
        <h3 id="name-fetching-entity-statements-">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-fetching-entity-statements-" class="section-name selfRef">Fetching Entity Statements (REQUIRED)</a>
        </h3>
<p id="section-6.1-1">
          Fetching entity statements is performed to collect entity statements
          one by one to gather trust chains.<a href="#section-6.1-1" class="pilcrow">Â¶</a></p>
<p id="section-6.1-2">
          To fetch an entity statement, an entity needs to know the
          identifier of the entity to ask (the issuer), the federation API
          endpoint of that entity and the identifier of the entity that you
          want the statement to be about (the subject).<a href="#section-6.1-2" class="pilcrow">Â¶</a></p>
<div id="fetch_statement">
<section id="section-6.1.1">
          <h4 id="name-fetch-entity-statements-req">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-fetch-entity-statements-req" class="section-name selfRef">Fetch Entity Statements Request</a>
          </h4>
<p id="section-6.1.1-1">
            The request MUST be a HTTP request using the GET method and
            the https scheme to a resolved federation API endpoint with the
            following query string parameters:<a href="#section-6.1.1-1" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-6.1.1-2">
            <dt id="section-6.1.1-2.1">operation</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-2.2">
                OPTIONAL. If not present, MUST be treated as
                <code>fetch</code>.<a href="#section-6.1.1-2.2" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-2.3">iss</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-2.4">
                REQUIRED. The entity identifier of the issuer
                from which you want an entity statement issued. Because of the
                normalization of the URL, multiple issuers may resolve to a
                shared federation API. This parameter makes it explicit exactly
                which issuer we want entity statements from.<a href="#section-6.1.1-2.4" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-2.5">sub</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-2.6">
                OPTIONAL. The entity identifier of the subject
                for which you would like an entity statement issued. If this
                parameter is left out, it is considered to be the same as the
                issuer and would indicate a request for a self-issued
                statement.<a href="#section-6.1.1-2.6" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-2.7">aud</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-2.8">
                OPTIONAL. The entity identifier of the
                requester. If the <code>aud</code>
 parameter is present in the request,
                the <code>aud</code> claim SHOULD be present in
                the entity statement response and take exactly that value.<a href="#section-6.1.1-2.8" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-6.1.1-3" class="keepWithNext">
              The following is a non-normative example of an API
              request for an entity statement:<a href="#section-6.1.1-3" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.1.1-4">
<pre>
GET /federation_api_endpoint?
iss=https%3A%2F%2Fopenid.sunet.se%2Ffederation HTTP/1.1
Host: openid.sunet.se
</pre><a href="#section-6.1.1-4" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<section id="section-6.1.2">
          <h4 id="name-fetch-entity-statements-res">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-fetch-entity-statements-res" class="section-name selfRef">Fetch Entity Statements Response</a>
          </h4>
<p id="section-6.1.2-1">
            A positive response is a signed entity statement where
            the content type MUST be set to
            <code>application/jose</code>.
            If it is a negative response, it will be a JSON object and the
            content type MUST be set to
            <code>application/json</code>.
            See more about error responses in <a href="#error_response" class="xref">Section 6.4</a>.<a href="#section-6.1.2-1" class="pilcrow">Â¶</a></p>
<p id="section-6.1.2-2" class="keepWithNext">
              The following is a non-normative example of a response, before
              serialization and adding a signature:<a href="#section-6.1.2-2" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.1.2-3">
<pre>
200 OK
Last-Modified: Mon, 17 Dec 2018 11:15:56 GMT
Content-Type: application/jose

{
  "iss": "https://openid.sunet.se",
  "sub": "https://openid.sunet.se",
  "iat": 1516239022,
  "exp": 1516298022,
  "metadata": {
    "openid_relying_party": {
      "application_type": "web",
      "redirect_uris": [
        "https://openid.sunet.se/rp/callback"
      ],
      "organization_name": "SUNET",
      "logo_uri": "https://www.sunet.se/sunet/images/32x32.png",
      "grant_types": [
        "authorization_code",
        "implicit"
      ],
      "jwks_uri": "https://openid.sunet.se/rp/jwks.json"
    }
  },
  "jwks": {
    "keys": [
      {
        "alg": "RS256",
        "e": "AQAB",
        "key_ops": [
          "verify"
        ],
        "kid": "key1",
        "kty": "RSA",
        "n": "pnXBOusEANuug6ewezb9J_...",
        "use": "sig"
      }
    ]
  },
  "authority_hints": [
    "https://edugain.org/federation"
  ]
}
</pre><a href="#section-6.1.2-3" class="pilcrow">Â¶</a>
</div>
</section>
</section>
<section id="section-6.2">
        <h3 id="name-trust-negotiation-optional">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-trust-negotiation-optional" class="section-name selfRef">Trust Negotiation (OPTIONAL)</a>
        </h3>
<p id="section-6.2-1">
          An entity may use the trust negotiation operation to fetch
          resolved metadata about itself as seen/trusted by a remote peer.
          The result may, for instance, tell an RP what operations, scopes and
          claims an OP would allow the RP to use if a specific trust anchor
          was used.<a href="#section-6.2-1" class="pilcrow">Â¶</a></p>
<section id="section-6.2.1">
          <h4 id="name-trust-negotiation-request">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-trust-negotiation-request" class="section-name selfRef">Trust Negotiation Request</a>
          </h4>
<p id="section-6.2.1-1">
            The request MUST be a HTTP request using the GET method and
            the https scheme to a resolved federation API endpoint with the
            following query string parameters:<a href="#section-6.2.1-1" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-6.2.1-2">
            <dt id="section-6.2.1-2.1">operation</dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-2.2">
                REQUIRED. MUST be set to
                <code>resolve_metadata</code>.<a href="#section-6.2.1-2.2" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-2.3">respondent</dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-2.4">
                REQUIRED. The entity identifier of the
                entity whose metadata are requested. Because of the
                normalization of the URL, multiple entity identifiers may
                resolve to a shared federation API. This parameter makes it
                explicit exactly which entity is expected.<a href="#section-6.2.1-2.4" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-2.5">peer</dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-2.6">
                REQUIRED. The entity identifier of the entity
                the information is requested for. This must be a leaf entity.<a href="#section-6.2.1-2.6" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-2.7">type</dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-2.8">
                REQUIRED. The metadata type to resolve.
                In this document, we use the metadata types listed in
                <a href="#metadata" class="xref">Section 3</a>.<a href="#section-6.2.1-2.8" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-2.9">anchor</dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-2.10">
                REQUIRED. The trust anchor that the remote peer
                MUST use when resolving the metadata. The value is an entity
                identifier.<a href="#section-6.2.1-2.10" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-6.2.1-3" class="keepWithNext">
              The following is a non-normative example of an API
              request for trust negotiation:<a href="#section-6.2.1-3" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.2.1-4">
<pre>
GET /federation_api_endpoint?
operation=resolve_metadata&amp;
respondent=https%3A%2F%2Fopenid.sunet.se%2Ffederation&amp;
type=openid_provider&amp;
anchor=https%3A%2F%2Fswamid.se&amp;
peer=https%3A%2F%2Fidp.umu.se%2Fopenid HTTP/1.1
Host: openid.sunet.se
</pre><a href="#section-6.2.1-4" class="pilcrow">Â¶</a>
</div>
</section>
<section id="section-6.2.2">
          <h4 id="name-trust-negotiation-response">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-trust-negotiation-response" class="section-name selfRef">Trust Negotiation Response</a>
          </h4>
<p id="section-6.2.2-1">
            The response is a metadata statement that is the result of
            applying the metadata policies in the trust chain on the entity's
            metadata.<a href="#section-6.2.2-1" class="pilcrow">Â¶</a></p>
<p id="section-6.2.2-2" class="keepWithNext">
              The following is a non-normative example of a response:<a href="#section-6.2.2-2" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.2.2-3">
<pre>
200 OK
Last-Modified: Wed, 22 Jul 2018 19:15:56 GMT
Content-Type: application/json

{
  "organization_name": "University of Umea",
  "contacts": [
    "legal@umu.se",
    "technical@umu.se"
  ],
  "logo_uri":
    "https://www.umu.se/SRWStatic/img/umu-logo-left-neg-SE.svg",
  "op_policy_uri":
    "https://www.umu.se/en/about-the-website/legal-information/",
  "authorization_endpoint":
    "https://idp.umu.se/openid/authorization",
  "token_endpoint": "https://idp.umu.se/openid/token",
  "response_types_supported": [
    "code",
    "code id_token",
    "token"
  ],
  "grant_types_supported": [
    "authorization_code",
    "implicit",
    "urn:ietf:params:oauth:grant-type:jwt-bearer"
  ],
  "subject_types_supported": [
    "pairwise"
  ],
  "id_token_signing_alg_values_supported": [
    "RS256"
  ],
  "issuer": "https://idp.umu.se/openid",
  "jwks_uri": "https://idp.umu.se/openid/jwks_uri.json"
}
</pre><a href="#section-6.2.2-3" class="pilcrow">Â¶</a>
</div>
</section>
</section>
<section id="section-6.3">
        <h3 id="name-entity-listings-optional">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-entity-listings-optional" class="section-name selfRef">Entity Listings (OPTIONAL)</a>
        </h3>
<p id="section-6.3-1">
          An entity may query another entity for a list of all the
          entities immediately subordinate to that entity and about which
          that entity is prepared to issue statements about.
          (In some cases, this may be a very large list.)<a href="#section-6.3-1" class="pilcrow">Â¶</a></p>
<section id="section-6.3.1">
          <h4 id="name-entity-listings-request">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-entity-listings-request" class="section-name selfRef">Entity Listings Request</a>
          </h4>
<p id="section-6.3.1-1">
            The request MUST be a HTTP request using the GET method and
            the https scheme to a resolved federation API endpoint with the
            following query string parameters:<a href="#section-6.3.1-1" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-6.3.1-2">
            <dt id="section-6.3.1-2.1">operation</dt>
            <dd style="margin-left: 1.5em" id="section-6.3.1-2.2">
                REQUIRED. MUST be set to
                <code>listing</code>.<a href="#section-6.3.1-2.2" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.3.1-2.3">iss</dt>
            <dd style="margin-left: 1.5em" id="section-6.3.1-2.4">
                REQUIRED. The entity identifier of the entity
                from which an entity listing is requested. Because of the
                normalization of the URL, multiple entity identifiers may
                resolve to a shared federation API. This parameter makes it
                explicit exactly which entity is expected.<a href="#section-6.3.1-2.4" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.3.1-2.5">is_leaf</dt>
            <dd style="margin-left: 1.5em" id="section-6.3.1-2.6">
                OPTIONAL. If left out, the result should
                include both leaf entities and intermediate nodes. If set to
                <code>true</code>,
                the response should contain only leaf entities. If set to
                <code>false</code>, the
                response should contain only intermediate nodes.<a href="#section-6.3.1-2.6" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-6.3.1-3" class="keepWithNext">
              The following is a non-normative example of an API
              request for trust negotiation:<a href="#section-6.3.1-3" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.3.1-4">
<pre>
GET /federation_api_endpoint?
operation=listing&amp;
iss=https%3A%2F%2Fopenid.sunet.se%2Ffederation HTTP/1.1
Host: openid.sunet.se
</pre><a href="#section-6.3.1-4" class="pilcrow">Â¶</a>
</div>
</section>
<section id="section-6.3.2">
          <h4 id="name-entity-listing-response">
<a href="#section-6.3.2" class="section-number selfRef">6.3.2. </a><a href="#name-entity-listing-response" class="section-name selfRef">Entity Listing Response</a>
          </h4>
<p id="section-6.3.2-1">
            The response MUST contain an JSON list with the known entity
            identifiers.<a href="#section-6.3.2-1" class="pilcrow">Â¶</a></p>
<p id="section-6.3.2-2" class="keepWithNext">
              The following is a non-normative example of a response:<a href="#section-6.3.2-2" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.3.2-3">
<pre>
200 OK
Last-Modified: Wed, 22 Jul 2018 19:15:56 GMT
Content-Type: application/json

[
  "https://ntnu.andreas.labs.uninett.no/",
  "https://blackboard.ntnu.no/openid/callback",
  "https://serviceprovider.andreas.labs.uninett.no/application17"
]
</pre><a href="#section-6.3.2-3" class="pilcrow">Â¶</a>
</div>
</section>
</section>
<div id="error_response">
<section id="section-6.4">
        <h3 id="name-generic-error-response">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-generic-error-response" class="section-name selfRef">Generic Error Response</a>
        </h3>
<p id="section-6.4-1">
          If the request was malformed, or some error occurred during
          processing of the request, the following standardized error format
          should be used regardless of the operation specified.<a href="#section-6.4-1" class="pilcrow">Â¶</a></p>
<p id="section-6.4-2">
          The HTTP response code MUST be something in 400/500-range, giving an
          indication of the type of error. The response body MUST be a JSON
          object containing the claims below and the content type MUST
          be set to <code>application/json</code>.<a href="#section-6.4-2" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-6.4-3">
          <dt id="section-6.4-3.1">operation</dt>
          <dd style="margin-left: 1.5em" id="section-6.4-3.2">
              REQUIRED. The operation of the request.<a href="#section-6.4-3.2" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-3.3">error</dt>
          <dd style="margin-left: 1.5em" id="section-6.4-3.4">
              REQUIRED. The error code.<a href="#section-6.4-3.4" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-3.5">error_description</dt>
          <dd style="margin-left: 1.5em" id="section-6.4-3.6">
              REQUIRED. A human-readable short
              text describing the error.<a href="#section-6.4-3.6" class="pilcrow">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.4-4" class="keepWithNext">
            The following is a non-normative example of an error response:<a href="#section-6.4-4" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.4-5">
<pre>
400 Bad request
Last-Modified: Wed, 22 Jul 2018 19:15:56 GMT
Content-Type: application/json

{
  "operation": "fetch",
  "error": "invalid_request",
  "error_description":
    "Required request parameter [iss] was missing."
}
</pre><a href="#section-6.4-5" class="pilcrow">Â¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="resolving_trust">
<section id="section-7">
      <h2 id="name-resolving-trust-chain-and-m">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-resolving-trust-chain-and-m" class="section-name selfRef">Resolving Trust Chain and Metadata</a>
      </h2>
<p id="section-7-1">
        An entity (e.g., the Consumer) that wants to establish trust with a
        remote peer, must have the remote peer's entity identifier and a list of
        entity identifiers of trust anchors together with the public version
        of their signing keys. The Consumer will first have to fetch
        sufficient entity statements to establish at least one chain of trust
        from the remote peer to one or more of the configured trust anchors.
        After that the entity MUST validate the trust chains independently,
        and -- if there are multiple valid trust chains and if the
        application demands it -- choose one.<a href="#section-7-1" class="pilcrow">Â¶</a></p>
<div id="fetching-es">
<section id="section-7.1">
        <h3 id="name-fetching-entity-statements-t">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-fetching-entity-statements-t" class="section-name selfRef">Fetching Entity Statements to Establish a Trust Chain</a>
        </h3>
<p id="section-7.1-1">
          Depending on the circumstances, the Consumer may either be
          handed the remote peer's self-issued entity statement, or it may
          have to fetch it by itself. If it needs to fetch it, it will use the
          process described in
          <a href="#fetch_statement" class="xref">Section 6.1.1</a>
          with both <code>iss</code> and
          <code>sub</code>
          containing the entity identifier
          of the remote peer.<a href="#section-7.1-1" class="pilcrow">Â¶</a></p>
<p id="section-7.1-2">
          The next step is to iterate through the list of
          intermediates listed in
          <code>authority_hints</code>, ignoring the authority
          hints that end in an unknown trust anchor, requesting an entity
          statement about the remote peer from each of the intermediates.
          If the received entity statement contains an authority hint this
          process is repeated. This time with the
          <code>iss</code>
          set to the
          intermediate's entity identifier and the <code>sub</code> to
          be
          the <code>iss</code> of the previous query.
          The Consumer SHOULD NOT attempt to fetch
          entity statements it already has fetched during this
          process (loop prevention).<a href="#section-7.1-2" class="pilcrow">Â¶</a></p>
<p id="section-7.1-3">
          A successful operation will return one or more lists of
          entity statements. Each of the lists terminating in a self-signed
          entity statement is issued by a trust anchor.<a href="#section-7.1-3" class="pilcrow">Â¶</a></p>
<p id="section-7.1-4">
          If there is no path from the remote peer to at least one of the
          trusted trust anchors, then the list will be empty and there is no
          way of establishing trust in the remote peer's information. How the
          Consumer deals with this is out of scope for this specification.<a href="#section-7.1-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="trust_chain_validation">
<section id="section-7.2">
        <h3 id="name-validating-a-trust-chain">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-validating-a-trust-chain" class="section-name selfRef">Validating a Trust Chain</a>
        </h3>
<p id="section-7.2-1">
          As described in <a href="#trust_chain" class="xref">Section 2.2</a>,
          a trust chain consists of an ordered list of entity
          statements. So whichever way the Consumer has acquired the set of
          entity statements, it must now verify that it is a proper trust chain
          using the rules laid out in that section.<a href="#section-7.2-1" class="pilcrow">Â¶</a></p>
<p id="section-7.2-2">
          To validate the chain, the following must be done:<a href="#section-7.2-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-3.1">
            <p id="section-7.2-3.1.1">
              For each entity statement ES[j] j=i,..,0:<a href="#section-7.2-3.1.1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-3.1.2.1">
                  Verify that the statement contains all the required claims.<a href="#section-7.2-3.1.2.1" class="pilcrow">Â¶</a>
</li>
              <li class="normal" id="section-7.2-3.1.2.2">
                  Verify that <code>iat</code> has a value in the
                  past.<a href="#section-7.2-3.1.2.2" class="pilcrow">Â¶</a>
</li>
              <li class="normal" id="section-7.2-3.1.2.3">
                  Verify that <code>exp</code> has a value that
                  is in the future.<a href="#section-7.2-3.1.2.3" class="pilcrow">Â¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-7.2-3.2">
              For j=0 verify that <code>iss</code> ==
              <code>sub</code>.<a href="#section-7.2-3.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-7.2-3.3">
              For j=0,...,i-1: Verify that ES[j]['iss'] == ES[j+1]['sub']<a href="#section-7.2-3.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-7.2-3.4">
              For j=0,...,i-1: Verify the signature of ES[j] using a public
              key carried in ES[j+1]['jwks'].<a href="#section-7.2-3.4" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-7.2-3.5">
              For j == 0 verify the signature of ES[0] using a public
              key carried in ES[0]['jwks'].<a href="#section-7.2-3.5" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-7.2-3.6">
              For j == i: verify that a) the issuer matches the configured
              identifier of a trust anchor and b) its signature is valid with
              the likewise configured public key of said trust anchor.<a href="#section-7.2-3.6" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-7.2-4">
          Verifying the signature is a much more expensive
          operation then verifying the correctness of the statement and the
          timestamps. An implementer MAY therefor chose to not verify the
          signature until all the other checks have been done.<a href="#section-7.2-4" class="pilcrow">Â¶</a></p>
<p id="section-7.2-5">Consumers MAY cache Entity Statements or signature verification
          results for a given time until they expire
          <a href="#trust_lifetime" class="xref">Section 7.4</a>.<a href="#section-7.2-5" class="pilcrow">Â¶</a></p>
<p id="section-7.2-6">
          Note that the second bullet point means that, at each step in the
          trust chain resolution, it must be verified that the signing JWK is
          also present in the <code>jwks</code>
   statement claim issued by the superior.<a href="#section-7.2-6" class="pilcrow">Â¶</a></p>
</section>
</div>
<section id="section-7.3">
        <h3 id="name-choosing-one-of-the-valid-t">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-choosing-one-of-the-valid-t" class="section-name selfRef">Choosing One of the Valid Trust Chains</a>
        </h3>
<p id="section-7.3-1">
          If multiple valid trust chains are found, the Consumer will
          need to decide on which one to use.<a href="#section-7.3-1" class="pilcrow">Â¶</a></p>
<p id="section-7.3-2">
          One simple rule would be to prefer a shorter chain over a longer one.<a href="#section-7.3-2" class="pilcrow">Â¶</a></p>
<p id="section-7.3-3">Consumers MAY follow other rules according to local policy.<a href="#section-7.3-3" class="pilcrow">Â¶</a></p>
</section>
<div id="trust_lifetime">
<section id="section-7.4">
        <h3 id="name-calculating-the-expiration-">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-calculating-the-expiration-" class="section-name selfRef">Calculating the Expiration Time of a Trust Chain</a>
        </h3>
<p id="section-7.4-1">
          Each entity statement in a trust chain is signed and MUST have an
          expiration time (exp) set. The expiration time of the whole trust
          chain is set to the minimum value of exp within the chain.<a href="#section-7.4-1" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-8">
      <h2 id="name-updating-metadata-key-rollo">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-updating-metadata-key-rollo" class="section-name selfRef">Updating Metadata, Key Rollover, and Revocation</a>
      </h2>
<p id="section-8-1">
        This specification allows for a smooth process of updating metadata
        and public keys.<a href="#section-8-1" class="pilcrow">Â¶</a></p>
<p id="section-8-2">
        As described above in <a href="#trust_lifetime" class="xref">Section 7.4</a>,
        each trust chain has an expiration time.
        A consumer of metadata using this specification MUST support
        refreshing a trust chain when it expires.
        How often a consumer should re-evaluate the trust chain depends on
        how quickly the consumer wants to find out that something has changed
        in the trust chain.<a href="#section-8-2" class="pilcrow">Â¶</a></p>
<section id="section-8.1">
        <h3 id="name-protocol-key-rollover">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-protocol-key-rollover" class="section-name selfRef">Protocol Key Rollover</a>
        </h3>
<p id="section-8.1-1">
          If a leaf entity publishes its public keys in the metadata part
          using <code>jwks</code>, setting an expiration time on
          the self-signed entity
          statement can be used to control how often the receiving entity is
          fetching an updated version of the public key.<a href="#section-8.1-1" class="pilcrow">Â¶</a></p>
</section>
<div id="key_rollover_anchor">
<section id="section-8.2">
        <h3 id="name-key-rollover-for-a-trust-an">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-key-rollover-for-a-trust-an" class="section-name selfRef">Key Rollover for a Trust Anchor</a>
        </h3>
<p id="section-8.2-1">
          A trust anchor must publish a self-signed entity statement about
          itself. The trust anchor SHOULD set a reasonable expiration
          time on that statement, such that the consumers will re-fetch the
          entity statement at reasonable intervals. If the trust anchor wants to
          roll over its signing keys it would have to:<a href="#section-8.2-1" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.2-2">
<li id="section-8.2-2.1">
              Add the new keys to the <code>jwks</code> representing
              the trust
              anchors signing keys.<a href="#section-8.2-2.1" class="pilcrow">Â¶</a>
</li>
          <li id="section-8.2-2.2">
              Keep signing the entity statement using
              the old keys for a long enough time period to allow all
              subordinates to have gotten access to the new keys.<a href="#section-8.2-2.2" class="pilcrow">Â¶</a>
</li>
          <li id="section-8.2-2.3">
              Switch to signing with the new keys.<a href="#section-8.2-2.3" class="pilcrow">Â¶</a>
</li>
          <li id="section-8.2-2.4">
              After a reasonable time period remove the old keys. What is
              regarded as a reasonable time is dependent on the security profile
              and risk assessment of the trust anchor.<a href="#section-8.2-2.4" class="pilcrow">Â¶</a>
</li>
        </ol>
<p id="section-8.2-3">
          It must be taken into consideration that clients may have
          manually configured public keys as part of their configuration.<a href="#section-8.2-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<section id="section-8.3">
        <h3 id="name-revocation">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-revocation" class="section-name selfRef">Revocation</a>
        </h3>
<p id="section-8.3-1">
          Since the consumers are expected to check the trust chain at regular,
          reasonably frequent times, this specification does not specify a
          standard revocation process. Specific federations may make a
          different choice and will then have to add such a process.<a href="#section-8.3-1" class="pilcrow">Â¶</a></p>
</section>
</section>
<div id="client_registration">
<section id="section-9">
      <h2 id="name-openid-connect-communicatio">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-openid-connect-communicatio" class="section-name selfRef">OpenID Connect Communication</a>
      </h2>
<p id="section-9-1">
        This section describes how the trust framework in this specification
        is used to establish trust between an RP and an OP
        that have no explicit configuration or registration in advance.<a href="#section-9-1" class="pilcrow">Â¶</a></p>
<p id="section-9-2">
        There are two alternative approaches to establish trust between an
        RP and an OP, which we call automatic and explicit
        registration. Members of a federation or a community
        should agree upon which one to use. While implementations should
        support both methods, deployments may choose to disable the use of one
        of them.<a href="#section-9-2" class="pilcrow">Â¶</a></p>
<p id="section-9-3">
        Independent of whether the RP uses automatic or explicit registration,
        the way that the RP learns about the OP is the same.
        It will use the procedure that is
        described in <a href="#resolving_trust" class="xref">Section 7</a>.<a href="#section-9-3" class="pilcrow">Â¶</a></p>
<div id="automatic">
<section id="section-9.1">
        <h3 id="name-automatic-registration">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-automatic-registration" class="section-name selfRef">Automatic Registration</a>
        </h3>
<p id="section-9.1-1">
          Automatic registration allows an RP to send Authorization Requests
          to an OP without first registering with the OP. It basically works by
          the OP using the Client ID in the request to find the RP's metadata
          using the process outlined in
          <a href="#resolving_trust" class="xref">Section 7</a>
          and then
          verifies that the RP is in control of a private key that is a
          companion
          to one of the public keys the RP published through its metadata.<a href="#section-9.1-1" class="pilcrow">Â¶</a></p>
<p id="section-9.1-2">
          For automatic registration to work a number of things must be valid:<a href="#section-9.1-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1-3.1">
              The Client ID of the RP
              MUST be set to be identical to the RP entity identifier.<a href="#section-9.1-3.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-9.1-3.2">
              Without a registration process, the RP does not have a
              client secret. Instead, the automatic registration model requires
              the
              RP to make use of asymmetric cryptography. Basically, the RP must
              prove that it has control of the RP's private keys.<a href="#section-9.1-3.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-9.1-3.3">
              The Client ID MUST be a URL from which the OP can
              fetch the RP's self-signed entity statement using the process
              described in <a href="#federation_configuration" class="xref">Section 5</a>.<a href="#section-9.1-3.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-9.1-3.4">
              The OP MUST publish that it supports a request authentication
              method using the metadata claim
              <code>request_authentication_methods_supported</code>.<a href="#section-9.1-3.4" class="pilcrow">Â¶</a>
</li>
        </ul>
<section id="section-9.1.1">
          <h4 id="name-authentication-request">
<a href="#section-9.1.1" class="section-number selfRef">9.1.1. </a><a href="#name-authentication-request" class="section-name selfRef">Authentication Request</a>
          </h4>
<p id="section-9.1.1-1">
            The Authentication Request is performed by passing a
     Request Object by value as described in Section 6.1 in
            <span><a href="#OpenID.Core" class="xref">OpenID Connect Core 1.0</a> [<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span>
            or using pushed authorization as described in
            <span><a href="#PAR" class="xref">Pushed Authorization Requests</a> [<a href="#PAR" class="xref">PAR</a>]</span>.<a href="#section-9.1.1-1" class="pilcrow">Â¶</a></p>
<section id="section-9.1.1.1">
            <h5 id="name-using-a-request-object">
<a href="#section-9.1.1.1" class="section-number selfRef">9.1.1.1. </a><a href="#name-using-a-request-object" class="section-name selfRef">Using a Request Object</a>
            </h5>
<p id="section-9.1.1.1-1">
              In the case where a Request Object is used, the value of the
              <code>request</code>
              parameter is a JWT whose Claims are the request parameters
              specified in Section 3.1.2 in
              <span><a href="#OpenID.Core" class="xref">OpenID Connect Core 1.0</a> [<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span>.
              The JWT MUST be signed and MAY be encrypted.
              The following restrictions apply to the JWT:<a href="#section-9.1.1.1-1" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-9.1.1.1-2">
              <dt id="section-9.1.1.1-2.1">aud</dt>
              <dd style="margin-left: 1.5em" id="section-9.1.1.1-2.2">
                  REQUIRED. The Audience (aud) MUST be the URL of the
                  Authorization Server's Authorization Endpoint.<a href="#section-9.1.1.1-2.2" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-9.1.1.1-2.3">iss</dt>
              <dd style="margin-left: 1.5em" id="section-9.1.1.1-2.4">
                  REQUIRED. The claim <code>iss</code>
   MUST contain the client identifier.<a href="#section-9.1.1.1-2.4" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-9.1.1.1-2.5">sub</dt>
              <dd style="margin-left: 1.5em" id="section-9.1.1.1-2.6">
                  MUST NOT be present. This together with the value of
   <code>aud</code>
                  should make reuse of the statement for
   <code>private_key_jwt</code>
   client authentication not feasible.<a href="#section-9.1.1.1-2.6" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-9.1.1.1-2.7">jti</dt>
              <dd style="margin-left: 1.5em" id="section-9.1.1.1-2.8">
                  REQUIRED. JWT ID. A unique identifier for the JWT, which can
                  be used to prevent reuse of the token. These tokens MUST only
                  be used once, unless conditions for reuse were negotiated
                  between the parties; any such negotiation is beyond the scope
                  of this specification.<a href="#section-9.1.1.1-2.8" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-9.1.1.1-2.9">exp</dt>
              <dd style="margin-left: 1.5em" id="section-9.1.1.1-2.10">
                  REQUIRED. Expiration time on or after which the JWT MUST
                  NOT be accepted for processing.<a href="#section-9.1.1.1-2.10" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-9.1.1.1-2.11">iat</dt>
              <dd style="margin-left: 1.5em" id="section-9.1.1.1-2.12">
                  OPTIONAL. Time at which the JWT was issued.<a href="#section-9.1.1.1-2.12" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-9.1.1.1-3" class="keepWithNext">
                The following is a non-normative example of the Claims in a
                Request Object before base64url encoding and signing:<a href="#section-9.1.1.1-3" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-9.1.1.1-4">
<pre>
{
  "aud": "https://op.example.org/authorization",
  "client_id": "https://rp.example.com",
  "exp": 1589699162,
  "iat": 1589699102,
  "iss": "https://rp.example.com",
  "jti": "4d3ec0f81f134ee9a97e0449be6d32be",
  "nonce": "4LX0mFMxdBjkGmtx7a8WIOnB",
  "redirect_uri": "https://rp.example.com/authz_cb",
  "response_type": "code",
  "scope": "openid profile email address phone",
  "state": "YmX8PM9I7WbNoMnnieKKBiptVW0sP2OZ",
  "sub": "https://rp.example.com"
}
</pre><a href="#section-9.1.1.1-4" class="pilcrow">Â¶</a>
</div>
<p id="section-9.1.1.1-5" class="keepWithNext">
                The following is a non-normative example of an Authorization
                Request using the request parameter (with line wraps within
                values for display purposes only):<a href="#section-9.1.1.1-5" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-9.1.1.1-6">
<pre>
https://server.example.com/authorize?
    redirect_uri=https%3A%2F%2Frp.example.com%2Fauthz_cb
    &amp;scope=openid+profile+email+address+phone
    &amp;response_type=code
    &amp;client_id=https%3A%2F%2Frp.example.com
    &amp;request=eyJhbGciOiJSUzI1NiIsImtpZCI6ImRVTjJhMDF3Umtoa1
      NXcGxRVGh2Y1ZCSU5VSXdUVWRPVUZVMlRtVnJTbWhFUVhnelpYbHB
      UemRRTkEifQ.eyJzdWIiOiAiaHR0cHM6Ly9ycC5leGFtcGxlLmNvb
      SIsICJpc3MiOiAiaHR0cHM6Ly9ycC5leGFtcGxlLmNvbSIsICJpYX
      QiOiAxNTkzNjE1Nzk0LCAiZXhwIjogMTU5MzYxNTg1NCwgImF1ZCI
      6ICJodHRwczovL29wLmV4YW1wbGUub3JnL2F1dGhvcml6YXRpb24i
      LCAianRpIjogIjlhNDY2Njc3ZDZkOTQ5OWZiOTFjNDg4YTY1NzA0N
      TU2In0.mFq0V4KIb6eM-WV5vvQAvSSwoUyi-cy_ASMDgR1-amotjK
      6El0T1WV9-Hdrkgi_zBJtARs6VE380GmwpXXuMF1p6y-IoyIBJUSR
      w9LaeK9oi3d1stTT_J6VL8JwsNuetB6r9YLAQS-1p6mFKsv7TQSjk
      xNHfw0BTxfZftcDnooCqusC17xrz11qEY1CCtjDbbxYM1cYfzGFwS
      I0UZneQUZqa2ChOqWTguumG7XonB5NFZWieAtvyyPZaSI7AW5wCs2
      sH6kjMxOHEAIvxygZZwKpTiToccYtU7t0n2xKRr-oYDQaFjuRIemE
      xsuzVl6pbvCVYqyjxFscS9NgDB-hAAQ
</pre><a href="#section-9.1.1.1-6" class="pilcrow">Â¶</a>
</div>
<section id="section-9.1.1.1.1">
              <h6 id="name-processing-the-authenticati">
<a href="#section-9.1.1.1.1" class="section-number selfRef">9.1.1.1.1. </a><a href="#name-processing-the-authenticati" class="section-name selfRef">Processing the Authentication Request</a>
              </h6>
<p id="section-9.1.1.1.1-1">
                When the OP receives an incoming Authentication Request,
                the OP supports OpenID Connect Federation, the incoming
                Client ID
                is a valid URL, and the OP does not have the Client ID
                registered as a known
                client, then the OP should try to resolve and fetch trust
                chains starting with the RP's entity
                statement as described in <a href="#fetching-es" class="xref">Section 7.1</a>.<a href="#section-9.1.1.1.1-1" class="pilcrow">Â¶</a></p>
<p id="section-9.1.1.1.1-2">
                The OP MUST then validate the possible trust chains, as
                described in
                <a href="#trust_chain_validation" class="xref">Section 7.2</a>,
                and resolve the RP metadata with type
                <code>openid_relying_party</code>.<a href="#section-9.1.1.1.1-2" class="pilcrow">Â¶</a></p>
<p id="section-9.1.1.1.1-3">
                The OP should furthermore consider the resolved metadata of the
                RP,
                and verify that it complies with the client metadata
                specification
                in <span><a href="#OpenID.Registration" class="xref">OpenID Connect Dynamic
                Client
                Registration 1.0</a> [<a href="#OpenID.Registration" class="xref">OpenID.Registration</a>]</span>.<a href="#section-9.1.1.1.1-3" class="pilcrow">Â¶</a></p>
<p id="section-9.1.1.1.1-4">
                Once the OP has the RP's metadata, it can verify that the client
                was actually the one sending the Authorization Request by
                verifying the signature of the Request Object using the key
                material the client published through its metadata.<a href="#section-9.1.1.1.1-4" class="pilcrow">Â¶</a></p>
</section>
</section>
<section id="section-9.1.1.2">
            <h5 id="name-using-pushed-authorization">
<a href="#section-9.1.1.2" class="section-number selfRef">9.1.1.2. </a><a href="#name-using-pushed-authorization" class="section-name selfRef">Using Pushed Authorization</a>
            </h5>
<p id="section-9.1.1.2-1">
              <span><a href="#PAR" class="xref">Pushed Authorization</a> [<a href="#PAR" class="xref">PAR</a>]</span>
              provides an
              interoperable way to push the payload of a Request Object
              directly to the AS in exchange for a
       <code>request_uri</code>.<a href="#section-9.1.1.2-1" class="pilcrow">Â¶</a></p>
<p id="section-9.1.1.2-2">
              When it comes to request authentication, the applicable
              methods are three:<a href="#section-9.1.1.2-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1.1.2-3.1">Using a JWT for Client authentication as described
                  for <code>private_key_jwt</code> in Section 9
                  of
                  <span><a href="#OpenID.Core" class="xref">OpenID Connect Core 1.0</a> [<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span>.<a href="#section-9.1.1.2-3.1" class="pilcrow">Â¶</a>
</li>
              <li class="normal" id="section-9.1.1.2-3.2">
                  mTLS as described in Section 2.2 of
                  <span>[<a href="#RFC8705" class="xref">RFC8705</a>]</span>
                  based on self-signed certificates.
                  In this case the self-signed certificate MUST be present as
                  the value of an <code>x5c</code>
   claim for one key in the JWKS describing
                  the RP's keys.<a href="#section-9.1.1.2-3.2" class="pilcrow">Â¶</a>
</li>
              <li class="normal" id="section-9.1.1.2-3.3">
                  mTLS as described in Section 2.1 of
                  <span>[<a href="#RFC8705" class="xref">RFC8705</a>]</span>
                  based on public key infrastructure (PKI).<a href="#section-9.1.1.2-3.3" class="pilcrow">Â¶</a>
</li>
            </ul>
<p id="section-9.1.1.2-4">
              Note that if mTLS is used, TLS client authentication must be
              configured and, in case of self-signed certificates, the server must
              omit trust chain validation (optional_no_ca).<a href="#section-9.1.1.2-4" class="pilcrow">Â¶</a></p>
<p id="section-9.1.1.2-5">Using the example above, a request could look like this:<a href="#section-9.1.1.2-5" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-9.1.1.2-6">
<pre>
POST /par HTTP/1.1
Host: op.example.org
Content-Type: application/x-www-form-urlencoded

redirect_uri=https%3A%2F%2Frp.example.com%2Fauthz_cb
&amp;scope=openid+profile+email+address+phone
&amp;response_type=code
&amp;nonce=4LX0mFMxdBjkGmtx7a8WIOnB
&amp;state=YmX8PM9I7WbNoMnnieKKBiptVW0sP2OZ
&amp;client_id=https%3A%2F%2Frp.example.com
&amp;client_assertion_type=urn%3Aietf%3Aparams%3Aoauth%3A
  client-assertion-type%3Ajwt-bearer
&amp;client_assertion=eyJhbGciOiJSUzI1NiIsImtpZCI6ImRVTjJ
  hMDF3Umtoa1NXcGxRVGh2Y1ZCSU5VSXdUVWRPVUZVMlRtVnJTbW
  hFUVhnelpYbHBUemRRTkEifQ.eyJzdWIiOiAiaHR0cHM6Ly9ycC
  5leGFtcGxlLmNvbSIsICJpc3MiOiAiaHR0cHM6Ly9ycC5leGFtc
  GxlLmNvbSIsICJpYXQiOiAxNTg5NzA0NzAxLCAiZXhwIjogMTU4
  OTcwNDc2MSwgImF1ZCI6ICJodHRwczovL29wLmV4YW1wbGUub3J
  nL2F1dGhvcml6YXRpb24iLCAianRpIjogIjM5ZDVhZTU1MmQ5Yz
  Q4ZjBiOTEyZGM1NTY4ZWQ1MGQ2In0.oUt9Knx_lxb4V2S0tyNFH
  CNZeP7sImBy5XDsFxv1cUpGkAojNXSy2dnU5HEzscMgNW4wguz6
  KDkC01aq5OfN04SuVItS66bsx0h4Gs7grKAp_51bClzreBVzU4g
  _-dFTgF15T9VLIgM_juFNPA_g4Lx7Eb5r37rWTUrzXdmfxeou0X
  FC2p9BIqItU3m9gmH0ojdBCUX5Up0iDsys6_npYomqitAcvaBRD
  PiuUBa5Iar9HVR-H7FMAr7aq7s-dH5gx2CHIfM3-qlc2-_Apsy0
  BrQl6VePR6j-3q6JCWvNw7l4_F2UpHeanHb31fLKQbK-1yoXDNz
  DwA7B0ZqmuSmMFQ</pre><a href="#section-9.1.1.2-6" class="pilcrow">Â¶</a>
</div>
<section id="section-9.1.1.2.1">
              <h6 id="name-processing-the-authenticatio">
<a href="#section-9.1.1.2.1" class="section-number selfRef">9.1.1.2.1. </a><a href="#name-processing-the-authenticatio" class="section-name selfRef">Processing the Authentication Request</a>
              </h6>
<p id="section-9.1.1.2.1-1">
                There are three different paths the OP must follow when
                processing the Authentication Request depending on which
                request authentication
                method that was used. It all starts the same though.
                When the OP receives an incoming Authentication Request,
                the OP supports OpenID Connect Federation, the incoming
                Client ID
                is a valid URL, the OP does not have the Client ID
                registered as a known client and the OP supports the request
                authentication method used then the OP should try to resolve and
                fetch trust chains starting with the RP's entity
                statement as described in <a href="#fetching-es" class="xref">Section 7.1</a>.<a href="#section-9.1.1.2.1-1" class="pilcrow">Â¶</a></p>
<p id="section-9.1.1.2.1-2">
                The OP should validate the possible trust chains, as described
                in
                <a href="#trust_chain_validation" class="xref">Section 7.2</a>,
                and resolve the RP metadata with type
                <code>openid_relying_party</code>.<a href="#section-9.1.1.2.1-2" class="pilcrow">Â¶</a></p>
<p id="section-9.1.1.2.1-3">
                The OP should consider the resolved metadata of the RP, and
                verify that it complies with the client metadata specification
                in
                <span><a href="#OpenID.Registration" class="xref">OpenID Connect Dynamic Client
                  Registration 1.0</a> [<a href="#OpenID.Registration" class="xref">OpenID.Registration</a>]</span>.<a href="#section-9.1.1.2.1-3" class="pilcrow">Â¶</a></p>
<p id="section-9.1.1.2.1-4">
                Once the OP has the RP's metadata, it can verify the client.
                This is where it diverges depending on which client
                authentication method was used.<a href="#section-9.1.1.2.1-4" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-9.1.1.2.1-5">
                <dt id="section-9.1.1.2.1-5.1">private_key_jwt</dt>
                <dd style="margin-left: 1.5em" id="section-9.1.1.2.1-5.2">
                    If this method is used, then the OP will try to verify the
                    signature of the signed JWT using the key material published
                    by the RP in its metadata. If the authentication is
                    successful, then the registration is regarded as correct.<a href="#section-9.1.1.2.1-5.2" class="pilcrow">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-9.1.1.2.1-5.3">tls_client_auth</dt>
                <dd style="margin-left: 1.5em" id="section-9.1.1.2.1-5.4">
                    If mTLS is used and the certificate used was not
                    self-signed, then the Subject Alternative Name of the
                    certificate
                    MUST match the entity identifier of the RP.<a href="#section-9.1.1.2.1-5.4" class="pilcrow">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-9.1.1.2.1-5.5">self_signed_tls_client_auth</dt>
                <dd style="margin-left: 1.5em" id="section-9.1.1.2.1-5.6">
                    If mTLS is used and the certificate used is a self-signed
                    certificate, then the certificate MUST be present as the
                    value
                    of an <code>x5c</code>
     claim for one key in the JWKS describing the RP's
                    keys.<a href="#section-9.1.1.2.1-5.6" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</section>
</section>
</section>
<section id="section-9.1.2">
          <h4 id="name-authentication-error-respon">
<a href="#section-9.1.2" class="section-number selfRef">9.1.2. </a><a href="#name-authentication-error-respon" class="section-name selfRef">Authentication Error Response</a>
          </h4>
<p id="section-9.1.2-1">
            If the OP fails to establish trust with the RP, it should use an
            appropriate error code, and an
            <code>error_description</code>
            that aids the RP to understand what is wrong.<a href="#section-9.1.2-1" class="pilcrow">Â¶</a></p>
<p id="section-9.1.2-2">
            In addition to the error codes defined in Section 3.1.2.6 of OpenID
            Connect Core, this specification also defines the following error
            codes:<a href="#section-9.1.2-2" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-9.1.2-3">
            <dt id="section-9.1.2-3.1">missing_trust_anchor</dt>
            <dd style="margin-left: 1.5em" id="section-9.1.2-3.2">
                No trusted trust anchor could be found.<a href="#section-9.1.2-3.2" class="pilcrow">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-9.1.2-3.3">validation_failed</dt>
            <dd style="margin-left: 1.5em" id="section-9.1.2-3.4">
                Trust chain validation failed.<a href="#section-9.1.2-3.4" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-9.1.2-4" class="keepWithNext">
              The following is a non-normative example error response:<a href="#section-9.1.2-4" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-9.1.2-5">
<pre>
HTTP/1.1 302 Found
  Location: https://client.example.org/cb?
    error=missing_trust_anchor
    &amp;error_description=
      Could%20not%20find%20a%20trusted%20anchor
    &amp;state=af0ifjsldkj
</pre><a href="#section-9.1.2-5" class="pilcrow">Â¶</a>
</div>
</section>
</section>
</div>
<div id="explicit">
<section id="section-9.2">
        <h3 id="name-explicit-registration">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-explicit-registration" class="section-name selfRef">Explicit Registration</a>
        </h3>
<p id="section-9.2-1">
          This method involves performing an explicit registration of a new
          client the first time an RP interacts with an OP
          using something that basically follows the steps in
          <span><a href="#OpenID.Registration" class="xref">OpenID Connect Dynamic Client
            Registration 1.0</a> [<a href="#OpenID.Registration" class="xref">OpenID.Registration</a>]</span>
          but where the client registration request
          is a signed entity statement.<a href="#section-9.2-1" class="pilcrow">Â¶</a></p>
<div id="Clireg">
<section id="section-9.2.1">
          <h4 id="name-client-registration">
<a href="#section-9.2.1" class="section-number selfRef">9.2.1. </a><a href="#name-client-registration" class="section-name selfRef">Client Registration</a>
          </h4>
<div id="Cliregreq">
<section id="section-9.2.1.1">
            <h5 id="name-client-registration-request">
<a href="#section-9.2.1.1" class="section-number selfRef">9.2.1.1. </a><a href="#name-client-registration-request" class="section-name selfRef">Client Registration Request</a>
            </h5>
<p id="section-9.2.1.1-1">
              The OP MUST support OpenID Dynamic Client Registration as extended
              by this specification.
              This is signaled by having the claim
              <code>federation_registration_endpoint</code>
              in the OP's metadata.<a href="#section-9.2.1.1-1" class="pilcrow">Â¶</a></p>
<p id="section-9.2.1.1-2">
              Given that the OP supports explicit registration, the RP
              progresses as follows:<a href="#section-9.2.1.1-2" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.2.1.1-3">
<li id="section-9.2.1.1-3.1">
                  Once it has the list of acceptable trust chains for the OP,
                  it MUST choose the subset it wants to progress with. The
                  subset can be as small as one trust chain, but it can also
                  contain more than one.<a href="#section-9.2.1.1-3.1" class="pilcrow">Â¶</a>
</li>
              <li id="section-9.2.1.1-3.2">
                  Based on the trust anchors referenced in the subset of
                  trust chains, the RP will choose a set of
                  <code>authority_hints</code>
                  from
                  its own set that terminate in those trust anchors.<a href="#section-9.2.1.1-3.2" class="pilcrow">Â¶</a>
</li>
              <li id="section-9.2.1.1-3.3">
                  The RP will now construct a self-signed entity statement
                  where the metadata statement chosen is influenced by the OPs
                  metadata and the <code>authority_hints</code> included
                  are picked by the process described above.
                  Note that the <code>aud</code> claim in the
                  entity statement is REQUIRED
                  in this case and MUST be set to the OP issuer identifier.<a href="#section-9.2.1.1-3.3" class="pilcrow">Â¶</a>
</li>
              <li id="section-9.2.1.1-3.4">
                  The entity statement is sent, using POST, to the
                  <code>federation_registration_endpoint</code>
                  defined in this document. The content type MUST be set to
                  <code>application/jose</code>.<a href="#section-9.2.1.1-3.4" class="pilcrow">Â¶</a>
</li>
            </ol>
</section>
</div>
<div id="cliregresp">
<section id="section-9.2.1.2">
            <h5 id="name-client-registration-respons">
<a href="#section-9.2.1.2" class="section-number selfRef">9.2.1.2. </a><a href="#name-client-registration-respons" class="section-name selfRef">Client Registration Response</a>
            </h5>
<section id="section-9.2.1.2.1">
              <h6 id="name-op-constructing-the-respons">
<a href="#section-9.2.1.2.1" class="section-number selfRef">9.2.1.2.1. </a><a href="#name-op-constructing-the-respons" class="section-name selfRef">OP Constructing the Response</a>
              </h6>
<p id="section-9.2.1.2.1-1">
                The trust chains MUST be constructed using the received
                entity statement.<a href="#section-9.2.1.2.1-1" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.2.1.2.1-2">
<li id="section-9.2.1.2.1-2.1">
                    After the OP receives the request, it collects and
                    evaluates the trust chains starting with the
                    <code>authority_hints</code>
                    in the registration request.
                    After it has verified at least one trust chain it
                    MUST verify that the signature on the received registration
                    request is correct.<a href="#section-9.2.1.2.1-2.1" class="pilcrow">Â¶</a>
</li>
                <li id="section-9.2.1.2.1-2.2">
                    If it finds more than one acceptable trust chain, it MUST
                    choose one trust anchor from those chains as the one it will
                    proceed with.<a href="#section-9.2.1.2.1-2.2" class="pilcrow">Â¶</a>
</li>
                <li id="section-9.2.1.2.1-2.3">
                    At this point, if there already exists a client
                    registration under the same entity identifier then that
                    registration MUST be regarded as invalid.
                    <code>Note</code>
                    that key material from the previous registration SHOULD be
                    kept to allow verifying a signature on, or decrypting
                    archived data.<a href="#section-9.2.1.2.1-2.3" class="pilcrow">Â¶</a>
</li>
                <li id="section-9.2.1.2.1-2.4">
                    The OP will now construct a metadata policy that, if
                    applied to the RP's metadata statement, will result in
                    metadata that the OP finds acceptable.
                    <code>Note</code>
                    that the Client ID the OP chooses does not have to be
                    the same as the entity identifier of the RP.
                    To the entity statement it will add a
                    <code>trust_anchor_id</code>
                    claim, containing the trust anchor chosen above.<a href="#section-9.2.1.2.1-2.4" class="pilcrow">Â¶</a>
</li>
                <li id="section-9.2.1.2.1-2.5">
                    It will sign and return the registration response (a signed
                    entity statement) to the RP.<a href="#section-9.2.1.2.1-2.5" class="pilcrow">Â¶</a>
</li>
              </ol>
</section>
<section id="section-9.2.1.2.2">
              <h6 id="name-rp-parsing-the-response">
<a href="#section-9.2.1.2.2" class="section-number selfRef">9.2.1.2.2. </a><a href="#name-rp-parsing-the-response" class="section-name selfRef">RP Parsing the Response</a>
              </h6>
<ol start="1" type="1" class="normal type-1" id="section-9.2.1.2.2-1">
<li id="section-9.2.1.2.2-1.1">
                    The RP verifies the correctness of the received entity
                    statement, making sure that the trust chains starting at the
                    <code>authority_hints</code>
                    terminate in trust anchors that were
                    referenced in the entity statement it sent to the OP.<a href="#section-9.2.1.2.2-1.1" class="pilcrow">Â¶</a>
</li>
                <li id="section-9.2.1.2.2-1.2">
                    The RP MUST NOT apply metadata policies from the trust
                    chains that the OP provides because those are not valid for
                    the RP's metadata.
                    The RP MUST apply policies to the metadata using one of its
                    own trust chains that ends in the trust anchor that the OP
                    chose.
                    Once it has applied those policies, it can then apply
                    the policy returned from the OP.
                    When it has applied all the metadata policies to its
                    metadata statement, it then stores
                    the result and can continue communicating with the OP
                    using the agreed-upon metadata.<a href="#section-9.2.1.2.2-1.2" class="pilcrow">Â¶</a>
</li>
                <li id="section-9.2.1.2.2-1.3">
                    At this point the RP also knows which trust chain it should
                    use when evaluating the OP's metadata. It can therefore
                    apply the metadata policies on the OP's metadata using the
                    relevant trust chain and store the result as the OPs
                    metadata.<a href="#section-9.2.1.2.2-1.3" class="pilcrow">Â¶</a>
</li>
                <li id="section-9.2.1.2.2-1.4">
                    If the RP does not accept the received entity statement for
                    some
                    reason,
                    then it has the choice to restart the
                    registration process or to give up.<a href="#section-9.2.1.2.2-1.4" class="pilcrow">Â¶</a>
</li>
              </ol>
</section>
</section>
</div>
</section>
</div>
<section id="section-9.2.2">
          <h4 id="name-after-client-registration">
<a href="#section-9.2.2" class="section-number selfRef">9.2.2. </a><a href="#name-after-client-registration" class="section-name selfRef">After Client Registration</a>
          </h4>
<p id="section-9.2.2-1">
            A client registration using this specification is not expected to
            be valid forever. The entity statements exchanged all have
            expiration times, which means that the registration will eventually
            time out. An OP can also, for administrative reasons, decide that a
            client registration is not valid anymore. An example of this could
            be that the OP leaves the federation in use.<a href="#section-9.2.2-1" class="pilcrow">Â¶</a></p>
<section id="section-9.2.2.1">
            <h5 id="name-what-the-rp-must-do">
<a href="#section-9.2.2.1" class="section-number selfRef">9.2.2.1. </a><a href="#name-what-the-rp-must-do" class="section-name selfRef">What the RP MUST Do</a>
            </h5>
<p id="section-9.2.2.1-1">
              At regular intervals, the RP MUST:<a href="#section-9.2.2.1-1" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.2.2.1-2">
<li id="section-9.2.2.1-2.1">
                  Starting with the OP's entity statement, resolve and verify
                  the trust chains it chooses to use when constructing the
                  registration request. If those trust chains do not exist
                  anymore or do not verify, then the registration should be
                  regarded as invalid and a new registration process should be
                  started.<a href="#section-9.2.2.1-2.1" class="pilcrow">Â¶</a>
</li>
              <li id="section-9.2.2.1-2.2">
                  If the OP's entity statement was properly formed the RP must
                  now verify that the entity statement it received about itself
                  from the OP is still valid.
                  Again, if that is not the case the registration
                  should be regarded as invalid and a new registration process
                  should be started.<a href="#section-9.2.2.1-2.2" class="pilcrow">Â¶</a>
</li>
            </ol>
<p id="section-9.2.2.1-3">
              What is regarded as reasonable intervals will depend on
              federation policies and risk assessment by the maintainer of
              the RP.<a href="#section-9.2.2.1-3" class="pilcrow">Â¶</a></p>
</section>
<section id="section-9.2.2.2">
            <h5 id="name-what-the-op-must-do">
<a href="#section-9.2.2.2" class="section-number selfRef">9.2.2.2. </a><a href="#name-what-the-op-must-do" class="section-name selfRef">What the OP MUST Do</a>
            </h5>
<p id="section-9.2.2.2-1">
              At regular intervals, the OP MUST:<a href="#section-9.2.2.2-1" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.2.2.2-2">
<li id="section-9.2.2.2-2.1">
                  If the signature on the registration request has expired it
                  MUST mark the registration as invalid and demand that the
                  RP MUST re-register. Else<a href="#section-9.2.2.2-2.1" class="pilcrow">Â¶</a>
</li>
              <li id="section-9.2.2.2-2.2">
                  starting with the RP's client registration request, the OP
                  MUST
                  verify that there still is a valid trust chain terminating in
                  the trust anchor the OP chose during the registration process.<a href="#section-9.2.2.2-2.2" class="pilcrow">Â¶</a>
</li>
            </ol>
</section>
</section>
<section id="section-9.2.3">
          <h4 id="name-expiration-times">
<a href="#section-9.2.3" class="section-number selfRef">9.2.3. </a><a href="#name-expiration-times" class="section-name selfRef">Expiration Times</a>
          </h4>
<p id="section-9.2.3-1">
            An OP MUST NOT assign an expiration time
            to an RP's registration that is later than the trust
            chain's expiration time.<a href="#section-9.2.3-1" class="pilcrow">Â¶</a></p>
</section>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">
        TBD Register <code>federation_types_supported</code> for OP metadata with initial
        values <code>automatic</code> and <code>explicit</code>.<a href="#section-10-1" class="pilcrow">Â¶</a></p>
<p id="section-10-2">
        TBD Register <code>federation_type</code> for RP registration metadata.<a href="#section-10-2" class="pilcrow">Â¶</a></p>
<p id="section-10-3">
        TBD Register <code>federation_registration_endpoint</code> for the OP metadata.<a href="#section-10-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="Security">
<section id="section-11">
      <h2 id="name-security-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-11-1">
        TBD<a href="#section-11-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="OpenID.Core">[OpenID.Core]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.B.</span>, <span class="refAuthor">de Medeiros, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"OpenID Connect Discovery 1.0"</span>, <time datetime="2015-08-03" class="refDate">3 August 2015</time>, <span>&lt;<a href="http://openid.net/specs/openid-connect-core-1_0.html">http://openid.net/specs/openid-connect-core-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Discovery">[OpenID.Discovery]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.B.</span>, and <span class="refAuthor">E. Jay</span>, <span class="refTitle">"OpenID Connect Discovery 1.0"</span>, <time datetime="2015-08-03" class="refDate">3 August 2015</time>, <span>&lt;<a href="http://openid.net/specs/openid-connect-discovery-1_0.html">http://openid.net/specs/openid-connect-discovery-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Registration">[OpenID.Registration]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">M.B. Jones</span>, <span class="refTitle">"OpenID Connect Dynamic Client Registration 1.0"</span>, <time datetime="2015-08-03" class="refDate">3 August 2015</time>, <span>&lt;<a href="http://openid.net/specs/openid-connect-registration-1_0.html">http://openid.net/specs/openid-connect-registration-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PAR">[PAR]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Tonge, D.</span>, and <span class="refAuthor">F. Skokan</span>, <span class="refTitle">"OAuth 2.0 Pushed Authorization Requests"</span>, <span>&lt;<a href="https://tools.ietf.org/id/draft-ietf-oauth-par-04.html">https://tools.ietf.org/id/draft-ietf-oauth-par-04.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3339">[RFC3339]</dt>
        <dd>
<span class="refAuthor">Klyne, G.</span> and <span class="refAuthor">C. Newman</span>, <span class="refTitle">"Date and Time on the Internet: Timestamps"</span>, <span class="seriesInfo">RFC 3339</span>, <span class="seriesInfo">DOI 10.17487/RFC3339</span>, <time datetime="2002-07" class="refDate">July 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3339">https://www.rfc-editor.org/info/rfc3339</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7515">[RFC7515]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7515">https://www.rfc-editor.org/info/rfc7515</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7517">[RFC7517]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Key (JWK)"</span>, <span class="seriesInfo">RFC 7517</span>, <span class="seriesInfo">DOI 10.17487/RFC7517</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7517">https://www.rfc-editor.org/info/rfc7517</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7523">[RFC7523]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Campbell, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants"</span>, <span class="seriesInfo">RFC 7523</span>, <span class="seriesInfo">DOI 10.17487/RFC7523</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7523">https://www.rfc-editor.org/info/rfc7523</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7591">[RFC7591]</dt>
        <dd>
<span class="refAuthor">Richer, J., Ed.</span>, <span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Machulak, M.</span>, and <span class="refAuthor">P. Hunt</span>, <span class="refTitle">"OAuth 2.0 Dynamic Client Registration Protocol"</span>, <span class="seriesInfo">RFC 7591</span>, <span class="seriesInfo">DOI 10.17487/RFC7591</span>, <time datetime="2015-07" class="refDate">July 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7591">https://www.rfc-editor.org/info/rfc7591</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8414">[RFC8414]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Metadata"</span>, <span class="seriesInfo">RFC 8414</span>, <span class="seriesInfo">DOI 10.17487/RFC8414</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8414">https://www.rfc-editor.org/info/rfc8414</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8615">[RFC8615]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Well-Known Uniform Resource Identifiers (URIs)"</span>, <span class="seriesInfo">RFC 8615</span>, <span class="seriesInfo">DOI 10.17487/RFC8615</span>, <time datetime="2019-05" class="refDate">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8615">https://www.rfc-editor.org/info/rfc8615</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8705">[RFC8705]</dt>
      <dd>
<span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">T. Lodderstedt</span>, <span class="refTitle">"OAuth 2.0 Mutual-TLS Client Authentication and Certificate-Bound Access Tokens"</span>, <span class="seriesInfo">RFC 8705</span>, <span class="seriesInfo">DOI 10.17487/RFC8705</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8705">https://www.rfc-editor.org/info/rfc8705</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC8446">[RFC8446]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="section-appendix.a">
      <h2 id="name-provider-information-discov">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-provider-information-discov" class="section-name selfRef">Provider Information Discovery and Client Registration in a Federation</a>
      </h2>
<p id="section-appendix.a-1">
        Let us assume the following: The project LIGO would like to offer access
        to its wiki to all OPs in EduGAIN. LIGO is registered to the InCommon
        federation.<a href="#section-appendix.a-1" class="pilcrow">Â¶</a></p>
<p id="section-appendix.a-2" class="keepWithNext">
          The players<a href="#section-appendix.a-2" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-appendix.a-3">
<pre>
                       EduGAIN
                          |
       +------------------+------------------+
       |                                     |
    SWAMID                               InCommon
       |                                     |
     umu.se                                  |
       |                                     |
   op.umu.se                           wiki.ligo.org
</pre><a href="#section-appendix.a-3" class="pilcrow">Â¶</a>
</div>
<p id="section-appendix.a-4">
        Both SWAMID and InCommon are identity federations in their own right.
        They also have in common that they both are members of
        the EduGAIN federation.<a href="#section-appendix.a-4" class="pilcrow">Â¶</a></p>
<p id="section-appendix.a-5">
        SWAMID and InCommon are different in how they register entities.
        SWAMID registers organizations and lets the organizations register
        entities that belong to the organization, while InCommon registers all
        entities directly and not beneath any organization entity.
        Hence the differences in depth in the federations.<a href="#section-appendix.a-5" class="pilcrow">Â¶</a></p>
<p id="section-appendix.a-6">
        Let us assume a researcher from Umeae University would like to
        login at
        the LIGO Wiki. At the Wiki, the researcher will use some kind of
        discovery service to find the home identity provider (op.umu.se)<a href="#section-appendix.a-6" class="pilcrow">Â¶</a></p>
<p id="section-appendix.a-7">
        Once the RP-part of the Wiki knows which OP it should talk to it has
        to find out a couple of things about the OP. All if those things
        can be found in the metadata. But finding the metadata is not enough;
        the RP also has to trust the metadata.<a href="#section-appendix.a-7" class="pilcrow">Â¶</a></p>
<p id="section-appendix.a-8">
        Let us start with discovering Provider information.<a href="#section-appendix.a-8" class="pilcrow">Â¶</a></p>
<div id="op_discovery">
<section id="section-a.1">
        <h2 id="name-the-ligo-wiki-discovers-the">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-the-ligo-wiki-discovers-the" class="section-name selfRef">The LIGO Wiki Discovers the OP's Metadata</a>
        </h2>
<p id="section-a.1-1">
          Metadata discovery is a sequence of steps that starts with the RP
          fetching the self-signed entity statement of the leaf (in this case
          https://op.umu.se) using the process defined in
          <a href="#federation_configuration" class="xref">Section 5</a>.
          What follows thereafter is this sequence of steps:<a href="#section-a.1-1" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-a.1-2">
<li id="section-a.1-2.1">Pick out the immediate superior entities using the authority
              hints<a href="#section-a.1-2.1" class="pilcrow">Â¶</a>
</li>
          <li id="section-a.1-2.2">
              Fetch the configuration for each such entity. This uses the
              process defined in
              <a href="#federation_configuration" class="xref">Section 5</a><a href="#section-a.1-2.2" class="pilcrow">Â¶</a>
</li>
          <li id="section-a.1-2.3">
              Using the federation API endpoint of the superiors do
              a fetch request
              <a href="#fetch_statement" class="xref">Section 6.1.1</a>
              on the endpoint asking for information about the subordinate
              entity.<a href="#section-a.1-2.3" class="pilcrow">Â¶</a>
</li>
        </ol>
<p id="section-a.1-3">
          How many times this has to be repeated depends on the depth of the
          federation. What follows below is the result of each step the RP
          has to take to find the OP's metadata using the federation setup
          described above.<a href="#section-a.1-3" class="pilcrow">Â¶</a></p>
<p id="section-a.1-4">
          When building the trust chain, the entity statements issued
          by a superior about its subordinate are used together with the
          self-signed entity statement issued by the leaf.<a href="#section-a.1-4" class="pilcrow">Â¶</a></p>
<p id="section-a.1-5">
          The self-signed entity statement concerning intermediates are not
          part of the trust chain.<a href="#section-a.1-5" class="pilcrow">Â¶</a></p>
<section id="section-a.1.1">
          <h3 id="name-configuration-information-f">
<a href="#section-a.1.1" class="section-number selfRef">A.1.1. </a><a href="#name-configuration-information-f" class="section-name selfRef">Configuration Information for op.umu.se</a>
          </h3>
<p id="section-a.1.1-1">The LIGO WIKI RP fetches the self-signed entity statement from the
            OP (op.umu.se)
            using the process defined in <a href="#federation_configuration" class="xref">Section 5</a>.<a href="#section-a.1.1-1" class="pilcrow">Â¶</a></p>
<p id="section-a.1.1-2" class="keepWithNext">The result is this entity statement.<a href="#section-a.1.1-2" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.1-3">
<pre>
{
  "authority_hints": [
    "https://umu.se"
  ],
  "exp": 1568397247,
  "iat": 1568310847,
  "iss": "https://op.umu.se",
  "jwks": {
    "keys": [
      {
        "e": "AQAB",
        "kid": "dEEtRjlzY3djcENuT01wOGxrZlkxb3RIQVJlMTY0...",
        "kty": "RSA",
        "n": "x97YKqc9Cs-DNtFrQ7_vhXoH9bwkDWW6En2jJ044yH..."
      }
    ]
  },
  "metadata": {
    "openid_provider": {
      "issuer": "https://op.umu.se/openid",
      "jwks_uri": "https://op.umu.se/openid/jwks_uri.json",
      "authorization_endpoint":
        "https://op.umu.se/openid/authorization",
      "client_registration_type": [
        "automatic",
        "explicit"
      ],
      "grant_types_supported": [
        "authorization_code",
        "implicit",
        "urn:ietf:params:oauth:grant-type:jwt-bearer"
      ],
      "id_token_signing_alg_values_supported": [
        "ES256", "RS256"
      ],
      "logo_uri":
        "https://www.umu.se/img/umu-logo-left-neg-SE.svg",
      "op_policy_uri":
        "https://www.umu.se/en/website/legal-information/",
      "response_types_supported": [
        "code",
        "code id_token",
        "token"
      ],
      "subject_types_supported": [
        "pairwise",
        "public"
      ],
      "token_endpoint": "https://op.umu.se/openid/token",
      "federation_registration_endpoint":
        "https://op.umu.se/openid/fedreg",
      "token_endpoint_auth_methods_supported": [
        "client_secret_post",
        "client_secret_basic",
        "client_secret_jwt",
        "private_key_jwt"
      ]
    }
  },
  "sub": "https://op.umu.se"
}
</pre><a href="#section-a.1.1-3" class="pilcrow">Â¶</a>
</div>
<p id="section-a.1.1-4">
            The <code>authority_hints</code> points to the
            intermediate https://umu.se. So that is the next step.<a href="#section-a.1.1-4" class="pilcrow">Â¶</a></p>
<p id="section-a.1.1-5">
            This entity statement is the first link in the trust chain.<a href="#section-a.1.1-5" class="pilcrow">Â¶</a></p>
</section>
<section id="section-a.1.2">
          <h3 id="name-configuration-information-fo">
<a href="#section-a.1.2" class="section-number selfRef">A.1.2. </a><a href="#name-configuration-information-fo" class="section-name selfRef">Configuration Information for 'https://umu.se'</a>
          </h3>
<p id="section-a.1.2-1">The LIGO RP fetches the self-signed entity statement from
            "https://umu.se" using the process defined in
            <a href="#federation_configuration" class="xref">Section 5</a>.<a href="#section-a.1.2-1" class="pilcrow">Â¶</a></p>
<p id="section-a.1.2-2">The request will look like this:<a href="#section-a.1.2-2" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.2-3">
<pre>
GET /.well-known/openid-federation HTTP/1.1
Host: umu.se
</pre><a href="#section-a.1.2-3" class="pilcrow">Â¶</a>
</div>
<p id="section-a.1.2-4">And the GET will return:<a href="#section-a.1.2-4" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.2-5">
<pre>
{
  "authority_hints": [
    "https://swamid.se"
  ],
  "exp": 1568397247,
  "iat": 1568310847,
  "iss": "https://umu.se",
  "jwks": {
    "keys": [
      {
        "e": "AQAB",
        "kid": "endwNUZrNTJsX2NyQlp4bjhVcTFTTVltR2gxV2RV...",
        "kty": "RSA",
        "n": "vXdXzZwQo0hxRSmZEcDIsnpg-CMEkor50SOG-1XUlM..."
      }
    ]
  },
  "metadata": {
    "federation_entity": {
      "contacts": "ops@umu.se",
      "federation_api_endpoint": "https://umu.se/oidc/fedapi",
      "homepage_uri": "https://www.umu.se",
      "name": "UmU"
    }
  },
  "sub": "https://umu.se"
}
</pre><a href="#section-a.1.2-5" class="pilcrow">Â¶</a>
</div>
<p id="section-a.1.2-6">
            The only piece of information that is used from this entity
            statement is
            the <code>federation_api_endpoint</code>,
            which is used in the next step.<a href="#section-a.1.2-6" class="pilcrow">Â¶</a></p>
</section>
<section id="section-a.1.3">
          <h3 id="name-entity-statement-published-">
<a href="#section-a.1.3" class="section-number selfRef">A.1.3. </a><a href="#name-entity-statement-published-" class="section-name selfRef">Entity Statement Published by 'https://umu.se' about 'https://op.umu.se'</a>
          </h3>
<p id="section-a.1.3-1">
            The RP uses the federation API and the "fetch" command as defined in
            <a href="#fetch_statement" class="xref">Section 6.1.1</a>
            to fetch information about
            "https://op.umu.se" from the API endpoint published in
            https://umu.se's configuration.<a href="#section-a.1.3-1" class="pilcrow">Â¶</a></p>
<p id="section-a.1.3-2">The request will look like this:<a href="#section-a.1.3-2" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.3-3">
<pre>
GET /oidc/fedapi?sub=https%3A%2F%2Fop.umu.se&amp;
iss=https%3A%2F%2Fumu.se HTTP/1.1
Host: umu.se
</pre><a href="#section-a.1.3-3" class="pilcrow">Â¶</a>
</div>
<p id="section-a.1.3-4">and the result is this:<a href="#section-a.1.3-4" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.3-5">
<pre>
{
  "authority_hints": [
    "https://swamid.se"
  ],
  "exp": 1568397247,
  "iat": 1568310847,
  "iss": "https://umu.se",
  "jwks": {
    "keys": [
      {
        "e": "AQAB",
        "kid": "dEEtRjlzY3djcENuT01wOGxrZlkxb3RIQVJlMTY0...",
        "kty": "RSA",
        "n": "x97YKqc9Cs-DNtFrQ7_vhXoH9bwkDWW6En2jJ044yH..."
      }
    ]
  },
  "metadata_policy": {
    "openid_provider": {
      "contacts": {
        "add": [
          "ops@swamid.se"
        ]
      },
      "organization_name": {
        "value": "University of Ume\u00e5"
      },
      "subject_types_supported": {
        "value": [
          "pairwise"
        ]
      },
      "token_endpoint_auth_methods_supported": {
        "default": [
          "private_key_jwt"
        ],
        "subset_of": [
          "private_key_jwt",
          "client_secret_jwt"
        ],
        "superset_of": [
          "private_key_jwt"
        ]
      }
    }
  },
  "sub": "https://op.umu.se"
}
</pre><a href="#section-a.1.3-5" class="pilcrow">Â¶</a>
</div>
<p id="section-a.1.3-6">
            This is the second link in the trust chain.<a href="#section-a.1.3-6" class="pilcrow">Â¶</a></p>
<p id="section-a.1.3-7">
            Notable here is that this path leads to two trust anchors using the
            same next step ("https://swamid.se").<a href="#section-a.1.3-7" class="pilcrow">Â¶</a></p>
</section>
<section id="section-a.1.4">
          <h3 id="name-configuration-information-for">
<a href="#section-a.1.4" class="section-number selfRef">A.1.4. </a><a href="#name-configuration-information-for" class="section-name selfRef">Configuration Information for 'https://swamid.se'</a>
          </h3>
<p id="section-a.1.4-1">The LIGO Wiki RP fetches the self-signed entity statement from
            "https://swamid.se" using the process defined in
            <a href="#federation_configuration" class="xref">Section 5</a>.<a href="#section-a.1.4-1" class="pilcrow">Â¶</a></p>
<p id="section-a.1.4-2">The request will look like this:<a href="#section-a.1.4-2" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.4-3">
<pre>
GET /.well-known/openid-federation HTTP/1.1
Host: swamid.se
</pre><a href="#section-a.1.4-3" class="pilcrow">Â¶</a>
</div>
<p id="section-a.1.4-4">And the GET will return:<a href="#section-a.1.4-4" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.4-5">
<pre>
{
  "authority_hints": [
    "https://edugain.geant.org"
  ],
  "exp": 1568397247,
  "iat": 1568310847,
  "iss": "https://swamid.se",
  "jwks": {
    "keys": [
      {
        "e": "AQAB",
        "kid": "N1pQTzFxUXZ1RXVsUkVuMG5uMnVDSURGRVdhUzdO...",
        "kty": "RSA",
        "n": "3EQc6cR_GSBq9km9-WCHY_lWJZWkcn0M05TGtH6D9S..."
      }
    ]
  },
  "metadata": {
    "federation_entity": {
      "contacts": "ops@swamid.se",
      "federation_api_endpoint":
        "https://swamid.sunet.se/fedapi",
      "homepage_uri": "https://www.sunet.se/swamid/",
      "name": "SWAMID"
    }
  },
  "sub": "https://swamid.se"
}
</pre><a href="#section-a.1.4-5" class="pilcrow">Â¶</a>
</div>
<p id="section-a.1.4-6">
            The only piece of information that is used from this entity
            statement is
            the <code>federation_api_endpoint</code>,
            which is used in the next step.<a href="#section-a.1.4-6" class="pilcrow">Â¶</a></p>
</section>
<section id="section-a.1.5">
          <h3 id="name-entity-statement-published-b">
<a href="#section-a.1.5" class="section-number selfRef">A.1.5. </a><a href="#name-entity-statement-published-b" class="section-name selfRef">Entity Statement Published by 'https://swamid.se' about 'https://umu.se'</a>
          </h3>
<p id="section-a.1.5-1">
            The LIGO Wiki RP uses the federation API and the "fetch" command as
            defined in
            <a href="#fetch_statement" class="xref">Section 6.1.1</a>
            to fetch information about
            "https://umu.se" from the API endpoint published in
            https://swamid.se's configuration.<a href="#section-a.1.5-1" class="pilcrow">Â¶</a></p>
<p id="section-a.1.5-2">The request will look like this:<a href="#section-a.1.5-2" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.5-3">
<pre>
GET /fedapi?sub=https%3A%2F%2Fumu.se&amp;
iss=https%3A%2F%2Fswamid.se HTTP/1.1
Host: swamid.se
</pre><a href="#section-a.1.5-3" class="pilcrow">Â¶</a>
</div>
<p id="section-a.1.5-4">and the result is this:<a href="#section-a.1.5-4" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.5-5">
<pre>
{
  "authority_hints": [
    "https://edugain.geant.org"
  ],
  "exp": 1568397247,
  "iat": 1568310847,
  "iss": "https://swamid.se",
  "jwks": {
    "keys": [
      {
        "e": "AQAB",
        "kid": "endwNUZrNTJsX2NyQlp4bjhVcTFTTVltR2gxV2RV...",
        "kty": "RSA",
        "n": "vXdXzZwQo0hxRSmZEcDIsnpg-CMEkor50SOG-1XUlM..."
      }
    ]
  },
  "metadata_policy": {
    "openid_provider": {
      "id_token_signing_alg_values_supported": {
        "subset_of": [
          "RS256",
          "ES256",
          "ES384",
          "ES512"
        ]
      },
      "token_endpoint_auth_methods_supported": {
        "subset_of": [
          "client_secret_jwt",
          "private_key_jwt"
        ]
      },
      "userinfo_signing_alg_values_supported": {
        "subset_of": [
          "ES256",
          "ES384",
          "ES512"
        ]
      }
    }
  },
  "sub": "https://umu.se"
}
</pre><a href="#section-a.1.5-5" class="pilcrow">Â¶</a>
</div>
<p id="section-a.1.5-6">
            This is the third link in the trust chain.<a href="#section-a.1.5-6" class="pilcrow">Â¶</a></p>
<p id="section-a.1.5-7">
            If we assume that the issuer of this entity statement is not in the
            list of trust anchors the LIGO Wiki RP has access to we have to go
            one step further.<a href="#section-a.1.5-7" class="pilcrow">Â¶</a></p>
</section>
<section id="section-a.1.6">
          <h3 id="name-configuration-information-for-">
<a href="#section-a.1.6" class="section-number selfRef">A.1.6. </a><a href="#name-configuration-information-for-" class="section-name selfRef">Configuration Information for 'https://edugain.geant.org'</a>
          </h3>
<p id="section-a.1.6-1">RP fetches the self-signed entity statement from
            "https://edugain.geant.org" using the process defined in
            <a href="#federation_configuration" class="xref">Section 5</a>.<a href="#section-a.1.6-1" class="pilcrow">Â¶</a></p>
<p id="section-a.1.6-2">The request will look like this:<a href="#section-a.1.6-2" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.6-3">
<pre>
GET /.well-known/openid-federation HTTP/1.1
Host: edugain.geant.org
</pre><a href="#section-a.1.6-3" class="pilcrow">Â¶</a>
</div>
<p id="section-a.1.6-4">And the GET will return:<a href="#section-a.1.6-4" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.6-5">
<pre>
{
  "exp": 1568397247,
  "iat": 1568310847,
  "iss": "https://edugain.geant.org",
  "jwks": {
    "keys": [
      {
        "e": "AQAB",
        "kid": "Sl9DcjFxR3hrRGdabUNIR21KT3dvdWMyc2VUM2Fr...",
        "kty": "RSA",
        "n": "xKlwocDXUw-mrvDSO4oRrTRrVuTwotoBFpozvlq-1q..."
      }
    ]
  },
  "metadata": {
    "federation_entity": {
      "federation_api_endpoint": "https://geant.org/edugain/api"
    }
  },
  "sub": "https://edugain.geant.org"
}

</pre><a href="#section-a.1.6-5" class="pilcrow">Â¶</a>
</div>
<p id="section-a.1.6-6">
            Again, the only thing we need is the
            <code>federation_api_endpoint</code>.
            As described in
            <a href="#key_rollover_anchor" class="xref">Section 8.2</a>,
            note should also be
            taken to <code>jwks</code> as the trust anchor may be
            performing a key rollover.<a href="#section-a.1.6-6" class="pilcrow">Â¶</a></p>
</section>
<section id="section-a.1.7">
          <h3 id="name-entity-statement-published-by">
<a href="#section-a.1.7" class="section-number selfRef">A.1.7. </a><a href="#name-entity-statement-published-by" class="section-name selfRef">Entity Statement Published by 'https://edugain.geant.org' about 'https://swamid.se'</a>
          </h3>
<p id="section-a.1.7-1">
            The LIGO Wiki RP uses the federation API and the "fetch" command as
            defined in
            <a href="#fetch_statement" class="xref">Section 6.1.1</a>
            to fetch information about
            "https://swamid.se" from the API endpoint published in
            https://edugain.geant.org's configuration.<a href="#section-a.1.7-1" class="pilcrow">Â¶</a></p>
<p id="section-a.1.7-2">The request will look like this:<a href="#section-a.1.7-2" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.7-3">
<pre>
GET /edugain/api?sub=https%3A%2F%2Fswamid.se&amp;
iss=https%3A%2F%2Fedugain.geant.org HTTP/1.1
Host: geant.org
</pre><a href="#section-a.1.7-3" class="pilcrow">Â¶</a>
</div>
<p id="section-a.1.7-4">and the result is this:<a href="#section-a.1.7-4" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.7-5">
<pre>
{
  "exp": 1568397247,
  "iat": 1568310847,
  "iss": "https://edugain.geant.org",
  "jwks": {
    "keys": [
      {
        "e": "AQAB",
        "kid": "N1pQTzFxUXZ1RXVsUkVuMG5uMnVDSURGRVdhUzdO...",
        "kty": "RSA",
        "n": "3EQc6cR_GSBq9km9-WCHY_lWJZWkcn0M05TGtH6D9S..."
      }
    ]
  },
  "metadata_policy": {
    "openid_provider": {
      "contacts": {
        "add": "ops@edugain.geant.org"
      }
    },
    "openid_relying_part": {
      "contacts": {
        "add": "ops@edugain.geant.org"
      }
    }
  },
  "sub": "https://swamid.se"
}
</pre><a href="#section-a.1.7-5" class="pilcrow">Â¶</a>
</div>
<p id="section-a.1.7-6">
            If we assume that the issuer of this statement appears in the list
            of trust anchors the LIGO Wiki RP has access to this would be
            the fourth and final entity statement in the trust chain.<a href="#section-a.1.7-6" class="pilcrow">Â¶</a></p>
<p id="section-a.1.7-7">
            We now have the whole chain from the self-signed entity statement of
            the
            leaf up until the last one that is issued by a trust anchor. All in
            all,
            we have:<a href="#section-a.1.7-7" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-a.1.7-8">
<li id="section-a.1.7-8.1">Self-signed entity statement by the leaf (https://op.umu.se)<a href="#section-a.1.7-8.1" class="pilcrow">Â¶</a>
</li>
            <li id="section-a.1.7-8.2">Statement issued by https://umu.se about https://op.umu.se<a href="#section-a.1.7-8.2" class="pilcrow">Â¶</a>
</li>
            <li id="section-a.1.7-8.3">Statement issued by https://swamid.se about https://umu.se<a href="#section-a.1.7-8.3" class="pilcrow">Â¶</a>
</li>
            <li id="section-a.1.7-8.4">Statement issued by https://edugain.geant.org about
                https://swamid.se<a href="#section-a.1.7-8.4" class="pilcrow">Â¶</a>
</li>
          </ol>
<p id="section-a.1.7-9">We also have the self-signed entity statements from https://umu.se,
            https://swamid.se and https://edugain.geant.org about themselves but
            those are not used in the trust chain verification.<a href="#section-a.1.7-9" class="pilcrow">Â¶</a></p>
<p id="section-a.1.7-10">
            Using the public keys of the trust anchor that the LIGO Wiki RP has
            been
            provided with in some secure out-of-band way, it can now verify the
            trust chain as described in
            <a href="#trust_chain_validation" class="xref">Section 7.2</a>.<a href="#section-a.1.7-10" class="pilcrow">Â¶</a></p>
</section>
<section id="section-a.1.8">
          <h3 id="name-verified-metadata-for-opumu">
<a href="#section-a.1.8" class="section-number selfRef">A.1.8. </a><a href="#name-verified-metadata-for-opumu" class="section-name selfRef">Verified Metadata for op.umu.se</a>
          </h3>
<p id="section-a.1.8-1">Having verified the chain, the LIGO Wiki RP can proceed with the
            next step.<a href="#section-a.1.8-1" class="pilcrow">Â¶</a></p>
<p id="section-a.1.8-2">Combining the metadata policies from the tree entity statements we
            have by
            a superior about its subordinate and applying the combined policy
            to the
            metadata statement that the leaf entity presented, we get:<a href="#section-a.1.8-2" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1.8-3">
<pre>
{
  "authorization_endpoint":
    "https://op.umu.se/openid/authorization",
  "claims_parameter_supported": false,
  "contacts": [
    "ops@swamid.se"
  ],
  "federation_registration_endpoint":
    "https://op.umu.se/openid/fedreg",
  "client_registration_type": [
    "automatic",
    "explicit"
  ],
  "grant_types_supported": [
    "authorization_code",
    "implicit",
    "urn:ietf:params:oauth:grant-type:jwt-bearer"
  ],
  "id_token_signing_alg_values_supported": [
    "RS256",
    "ES256"
  ],
  "issuer": "https://op.umu.se/openid",
  "jwks_uri": "https://op.umu.se/openid/jwks_uri.json",
  "logo_uri":
    "https://www.umu.se/img/umu-logo-left-neg-SE.svg",
  "organization_name": "University of Ume\u00e5",
  "op_policy_uri":
    "https://www.umu.se/en/website/legal-information/",
  "request_parameter_supported": false,
  "request_uri_parameter_supported": true,
  "require_request_uri_registration": true,
  "response_types_supported": [
    "code",
    "code id_token",
    "token"
  ],
  "subject_types_supported": [
    "pairwise"
  ],
  "token_endpoint": "https://op.umu.se/openid/token",
  "token_endpoint_auth_methods_supported": [
    "private_key_jwt",
    "client_secret_jwt"
  ],
  "version": "3.0"
}

</pre><a href="#section-a.1.8-3" class="pilcrow">Â¶</a>
</div>
<p id="section-a.1.8-4">
            We have now reached the end of the Provider Discovery process.<a href="#section-a.1.8-4" class="pilcrow">Â¶</a></p>
</section>
</section>
</div>
<section id="section-a.2">
        <h2 id="name-the-two-ways-of-doing-clien">
<a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-the-two-ways-of-doing-clien" class="section-name selfRef">The Two Ways of Doing Client Registration</a>
        </h2>
<p id="section-a.2-1">
          As described in
          <a href="#client_registration" class="xref">Section 9</a>,
          there are two
          ways which can be used to do client registration:<a href="#section-a.2-1" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-a.2-2">
          <dt id="section-a.2-2.1">Automatic</dt>
          <dd style="margin-left: 1.5em" id="section-a.2-2.2">
              No negotiation between the RP and the OP is made regarding
              what features the client should use in future communication are
              done. The RP's published metadata filtered by the chosen trust
              chain's
              metadata policies defines the metadata that is to be used.<a href="#section-a.2-2.2" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-a.2-2.3">Explicit</dt>
          <dd style="margin-left: 1.5em" id="section-a.2-2.4">
              The RP will access the
              <code>federation_registration_endpoint</code>,
              which provides the metadata for the RP to use. The OP MAY return a
              metadata policy that adds restrictions over and above what the
              trust chain already has defined.<a href="#section-a.2-2.4" class="pilcrow">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<section id="section-a.2.1">
          <h3 id="name-rp-sends-authentication-req">
<a href="#section-a.2.1" class="section-number selfRef">A.2.1. </a><a href="#name-rp-sends-authentication-req" class="section-name selfRef">RP Sends Authentication Request (Automatic Registration)</a>
          </h3>
<p id="section-a.2.1-1">
            The LIGO Wiki RP does not do any registration but goes directly to
            sending an Authentication Request.<a href="#section-a.2.1-1" class="pilcrow">Â¶</a></p>
<p id="section-a.2.1-2">
            Here is an example of such an Authentication Request:<a href="#section-a.2.1-2" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.2.1-3">
<pre>
GET /authorize?
  request=eyJhbGciOiJSUzI1NiIsImtpZCI6ImRVTjJhMDF3Umtoa1NXc
    GxRVGh2Y1ZCSU5VSXdUVWRPVUZVMlRtVnJTbWhFUVhnelpYbHBUemRR
    TkEifQ.eyJyZXNwb25zZV90eXBlIjogImNvZGUiLCAic2NvcGUiOiAi
    b3BlbmlkIHByb2ZpbGUgZW1haWwiLCAiY2xpZW50X2lkIjogImh0dHB
    zOi8vd2lraS5saWdvLm9yZyIsICJzdGF0ZSI6ICIyZmY3ZTU4OS0zOD
    Q4LTQ2ZGEtYTNkMi05NDllMTIzNWU2NzEiLCAibm9uY2UiOiAiZjU4M
    WExODYtYWNhNC00NmIzLTk0ZmMtODA0ODQwODNlYjJjIiwgInJlZGly
    ZWN0X3VyaSI6ICJodHRwczovL3dpa2kubGlnby5vcmcvb3BlbmlkL2N
    hbGxiYWNrIiwgImlzcyI6ICIiLCAiaWF0IjogMTU5MzU4ODA4NSwgIm
    F1ZCI6ICJodHRwczovL29wLnVtdS5zZSJ9.cRwSFNcDx6VsacAQDcIx
    5OAt_Pj30I_uUKRh04N4QJd6MZ0f50sETRv8uspSt9fMa-5yV3uzthX
    _v8OtQrV33gW1vzgOSRCdHgeCN40StbzjFk102seDwtU_Uzrcsy7KrX
    YSBp8U0dBDjuxC6h18L8ExjeR-NFjcrhy0wwua7Tnb4QqtN0QCia6DD
    8QBNVTL1Ga0YPmMdT25wS26wug23IgpbZB20VUosmMGgGtS5yCI5AwK
    Bhozv-oBH5KxxHzH1Oss-RkIGiQnjRnaWwEOTITmfZWra1eHP254wFF
    2se-EnWtz1q2XwsD9NSsOEJwWJPirPPJaKso8ng6qrrOSgw
  &amp;response_type=code
  &amp;client_id=https%3A%2F%2Fwiki.ligo.org
  &amp;redirect_uri=https%3A%2F%2Fwiki.ligo.org/openid/callback
  &amp;scope=openid+profile+email
  HTTP/1.1
Host: op.umu.se
</pre><a href="#section-a.2.1-3" class="pilcrow">Â¶</a>
</div>
<p id="section-a.2.1-4">
            The OP receiving this Authentication Request will, unless the
            RP is already registered, start to dynamically fetch
            and
            establish trust with the RP.<a href="#section-a.2.1-4" class="pilcrow">Â¶</a></p>
<section id="section-a.2.1.1">
            <h4 id="name-op-fetches-entity-statement">
<a href="#section-a.2.1.1" class="section-number selfRef">A.2.1.1. </a><a href="#name-op-fetches-entity-statement" class="section-name selfRef">OP Fetches Entity Statements</a>
            </h4>
<p id="section-a.2.1.1-1">
              The OP needs to establish a trust chain for the RP
              (wiki.ligo.org).
              The OP in this example is configured with public keys of two
              federations:<a href="#section-a.2.1.1-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-a.2.1.1-2.1">https://edugain.geant.org<a href="#section-a.2.1.1-2.1" class="pilcrow">Â¶</a>
</li>
              <li class="normal" id="section-a.2.1.1-2.2">https://swamid.se<a href="#section-a.2.1.1-2.2" class="pilcrow">Â¶</a>
</li>
            </ul>
<p id="section-a.2.1.1-3">
              The OP starts to resolve metadata for the client identifier
              https://wiki.ligo.org by fetching the self-issued entity statement
              using
              the process described in <a href="#federation_configuration" class="xref">Section 5</a>.<a href="#section-a.2.1.1-3" class="pilcrow">Â¶</a></p>
<p id="section-a.2.1.1-4">
              The process is the same as described in
              <a href="#op_discovery" class="xref">Appendix A.1</a>
              and will result in a trust chain with the following entity
              statements:<a href="#section-a.2.1.1-4" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-a.2.1.1-5">
<li id="section-a.2.1.1-5.1">Self-signed entity statement by the leaf
                  https://wiki.ligo.org<a href="#section-a.2.1.1-5.1" class="pilcrow">Â¶</a>
</li>
              <li id="section-a.2.1.1-5.2">Statement issued by https://incommon.org about
                  https://wiki.ligo.org<a href="#section-a.2.1.1-5.2" class="pilcrow">Â¶</a>
</li>
              <li id="section-a.2.1.1-5.3">Statement issued by https://edugain.geant.org about
                  https://incommon.org<a href="#section-a.2.1.1-5.3" class="pilcrow">Â¶</a>
</li>
            </ol>
</section>
<div id="rp_metadata_eval">
<section id="section-a.2.1.2">
            <h4 id="name-op-evaluates-the-rp-metadat">
<a href="#section-a.2.1.2" class="section-number selfRef">A.2.1.2. </a><a href="#name-op-evaluates-the-rp-metadat" class="section-name selfRef">OP Evaluates the RP Metadata</a>
            </h4>
<p id="section-a.2.1.2-1">
              Using the public keys of the trust anchor that the LIGO Wiki RP
              has
              been
              provided with in some secure out-of-band way, it can now verify
              the
              trust chain as described in
              <a href="#trust_chain_validation" class="xref">Section 7.2</a>.<a href="#section-a.2.1.2-1" class="pilcrow">Â¶</a></p>
<p id="section-a.2.1.2-2">
              We will not list the complete entity statements but only the
              <code>metadata</code>
              and <code>metadata_policy</code> parts.
              There are two metadata policies:<a href="#section-a.2.1.2-2" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-a.2.1.2-3">
              <dt id="section-a.2.1.2-3.1">edugain.geant.org</dt>
              <dd style="margin-left: 1.5em" id="section-a.2.1.2-3.2">
                <div class="artwork art-text alignLeft" id="section-a.2.1.2-3.2.1">
<pre>
"metadata_policy": {
  "openid_provider": {
    "contacts": {
      "add": "ops@edugain.geant.org"
    }
  },
  "openid_relying_party": {
    "contacts": {
      "add": "ops@edugain.geant.org"
    }
  }
}
</pre><a href="#section-a.2.1.2-3.2.1" class="pilcrow">Â¶</a>
</div>
</dd>
            <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlParallel" id="section-a.2.1.2-4">
              <dt id="section-a.2.1.2-4.1">incommon.org</dt>
              <dd style="margin-left: 1.5em" id="section-a.2.1.2-4.2">
                <div class="artwork art-text alignLeft" id="section-a.2.1.2-4.2.1">
<pre>
"metadata_policy": {
  "openid_relying_party": {
    "application_type": {
      "one_of": [
        "web",
        "native"
      ]
    },
    "contacts": {
      "add": "ops@incommon.org"
    },
    "grant_types": {
      "subset_of": [
        "authorization_code",
        "refresh_token"
      ]
    }
  }
}
</pre><a href="#section-a.2.1.2-4.2.1" class="pilcrow">Â¶</a>
</div>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-a.2.1.2-5">
              If you combine these and apply them to the metadata for
              wiki.ligo.org :<a href="#section-a.2.1.2-5" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.2.1.2-6">
<pre>
"metadata": {
  "application_type": "web",
  "client_name": "LIGO Wiki",
  "contacts": [
    "ops@ligo.org"
  ],
  "grant_types": [
    "authorization_code",
    "refresh_token"
  ],
  "id_token_signing_alg_values_supported": [
    "RS256",
    "RS512"
  ],
  "jwks_uri": "https://wiki.ligo.org/jwks.json",
  "redirect_uris": [
    "https://wiki.ligo.org/callback"
  ],
  "response_types": [
    "code"
  ],
  "subject_type": "public"
}
</pre><a href="#section-a.2.1.2-6" class="pilcrow">Â¶</a>
</div>
<p id="section-a.2.1.2-7">
              You will get<a href="#section-a.2.1.2-7" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.2.1.2-8">
<pre>
{
  "application_type": "web",
  "client_name": "LIGO Wiki",
  "contacts": [
    "ops@ligo.org",
    "ops@edugain.geant.org",
    "ops@incommon.org"
  ],
  "grant_types": [
    "refresh_token",
    "authorization_code"
  ],
  "id_token_signing_alg_values_supported": [
    "RS256",
    "RS512"
  ],
  "jwks_uri": "https://wiki.ligo.org/jwks.json",
  "redirect_uris": [
    "https://wiki.ligo.org/callback"
  ],
  "response_types": [
    "code"
  ],
  "subject_type": "public"
}
</pre><a href="#section-a.2.1.2-8" class="pilcrow">Â¶</a>
</div>
<p id="section-a.2.1.2-9">
              Having that, the registration is done, and the OP must now use
              the keys found at the URL specified in
              <code>jwks_uri</code>
              to verify the signature on the Request Object in the
              Authentication Request.<a href="#section-a.2.1.2-9" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
<section id="section-a.2.2">
          <h3 id="name-client-starts-with-registra">
<a href="#section-a.2.2" class="section-number selfRef">A.2.2. </a><a href="#name-client-starts-with-registra" class="section-name selfRef">Client Starts with Registration (Explicit Client Registration)</a>
          </h3>
<p id="section-a.2.2-1">
            Here the LIGO Wiki RP sends a client registration request to the
            <code>federation_registration_endpoint</code>
     of the OP (op.umu.se).
            What it sends is a self-signed entity statement.<a href="#section-a.2.2-1" class="pilcrow">Â¶</a></p>
<p id="section-a.2.2-2">
            Once the OP has the entity statement, it proceeds with the same
            sequence of steps as laid out in <a href="#op_discovery" class="xref">Appendix A.1</a>.<a href="#section-a.2.2-2" class="pilcrow">Â¶</a></p>
<p id="section-a.2.2-3">
            The OP will end up with the same RP metadata as was described in
            <a href="#rp_metadata_eval" class="xref">Appendix A.2.1.2</a>, but what it now can do is
            return a metadata policy that it wants to be applied to the RP's
            metadata. This metadata policy will be combined with the
            trust chain's combined metadata policy before being applied to the
            RP's metadata.<a href="#section-a.2.2-3" class="pilcrow">Â¶</a></p>
<p id="section-a.2.2-4">
            If we assume that the OP does not support refresh tokens,
            it may want to add a metadata policy that says:<a href="#section-a.2.2-4" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.2.2-5">
<pre>
"metadata_policy": {
  "openid_relying_party": {
    "grant_types": {
      "subset_of": [
        "authorization_code"
      ]
    }
  }
}
</pre><a href="#section-a.2.2-5" class="pilcrow">Â¶</a>
</div>
<p id="section-a.2.2-6">
            Thus, the entity statement returned by the OP to the RP may look
            like this:<a href="#section-a.2.2-6" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.2.2-7">
<pre>

{
  "trust_anchor_id": "https://edugain.geant.org",
  "metadata_policy": {
    "openid_relying_party": {
      "application_type": {
        "one_of": [
          "web",
          "native"
        ]
      },
      "contacts": {
        "add": [
          "ops@incommon.org",
          "ops@edugain.geant.org"
        ]
      },
      "grant_types": {
        "subset_of": [
          "authorization_code",
          "refresh_token"
        ]
      }
      "registration_access_token": {
        "value": "nLe19cJ5e9SXXiPqnRRuxpjyWI73bDhD"
      },
      "client_id": {
        "value": "m3GyHwVlyld3"
      },
      "client_secret_expires_at": {
        "value": 1604049619
      },
      "registration_client_uri": {
        "value":
          "https://op.umu.se/openid/registration_api?client_id=m3GyHwVl"
      },
      "client_secret": {
        "value": "cb44eed577f3b5edf3e08362d47a0dc44630b3dc6ea99f7a79205"
      },
      "client_id_issued_at": {
        "value": 1601457619
      }
    }
  },
  "authority_hints": [
    "https://incommon.org"
  ],
  "aud": "https://wiki.ligo.org",
  "jwks": {
    "keys": [
      {
        "kty": "RSA",
        "use": "sig",
        "kid":
          "U2JTWHY0VFg0a2FEVVdTaHptVDJsNDNiSDk5MXRBVEtNSFVkeXZwbTZ2QQ",
        "e": "AQAB",
        "n":
          "4AZjgqFwMhTVSLrpzzNcwaCyVD88C_Hb3Bmor97vH-2AzldhuVb8Ka..."
      },
      {
        "kty": "EC",
        "use": "sig",
        "kid":
          "LWtFcklLOGdrWXdvN1hjS2tjSUEzbG5VYTRrd0djdHgyQjVGUVB1MXBCdw",
        "crv": "P-256",
        "x": "X2S1dFE7zokQDST0bfHdlOWxOc8FC1l4_sG1Kwa4l4s",
        "y": "812nU6OCKxgc2ZgSPt_dkXbYldG_smHJi4wXByDHc6g"
      }
    ]
  },
  "iss": "https://op.umu.se",
  "iat": 1601457619,
  "exp": 1601544019
}
</pre><a href="#section-a.2.2-7" class="pilcrow">Â¶</a>
</div>
<p id="section-a.2.2-8">
            And the resulting metadata used by the RP could look like:<a href="#section-a.2.2-8" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.2.2-9">
<pre>
{
  "application_type": "web",
  "client_name": "LIGO Wiki",
  "contacts": [
    "ops@edugain.geant.org",
    "ops@incommon.org",
    "ops@ligo.org"
  ],
  "grant_types": [
    "authorization_code"
  ],
  "id_token_signing_alg_values_supported": [
    "RS256",
    "RS512"
  ],
  "jwks_uri": "https://wiki.ligo.org/jwks.json",
  "redirect_uris": [
    "https://wiki.ligo.org/callback"
  ],
  "response_types": [
    "code"
  ],
  "subject_type": "public"
}
</pre><a href="#section-a.2.2-9" class="pilcrow">Â¶</a>
</div>
</section>
</section>
</section>
<div id="Notices">
<section id="section-appendix.b">
      <h2 id="name-notices">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-notices" class="section-name selfRef">Notices</a>
      </h2>
<p id="section-appendix.b-1">
        Copyright (c) 2021 The OpenID Foundation.<a href="#section-appendix.b-1" class="pilcrow">Â¶</a></p>
<p id="section-appendix.b-2">
        The OpenID Foundation (OIDF) grants to any Contributor, developer,
        implementer, or other interested party a non-exclusive, royalty free,
        worldwide copyright license to reproduce, prepare derivative works from,
        distribute, perform and display, this Implementers Draft or Final
        Specification solely for the purposes of (i) developing specifications,
        and (ii) implementing Implementers Drafts and Final Specifications based
        on such documents, provided that attribution be made to the OIDF as the
        source of the material, but that such attribution does not indicate an
        endorsement by the OIDF.<a href="#section-appendix.b-2" class="pilcrow">Â¶</a></p>
<p id="section-appendix.b-3">
        The technology described in this specification was made available
        from contributions from various sources, including members of the OpenID
        Foundation and others. Although the OpenID Foundation has taken steps to
        help ensure that the technology is available for distribution, it takes
        no position regarding the validity or scope of any intellectual property
        or other rights that might be claimed to pertain to the implementation
        or use of the technology described in this specification or the extent
        to which any license under such rights might or might not be available;
        neither does it represent that it has made any independent effort to
        identify any such rights. The OpenID Foundation and the contributors to
        this specification make no (and hereby expressly disclaim any)
        warranties (express, implied, or otherwise), including implied
        warranties of merchantability, non-infringement, fitness for a
        particular purpose, or title, related to this specification, and the
        entire risk as to implementing this specification is assumed by the
        implementer. The OpenID Intellectual Property Rights policy requires
        contributors to offer a patent promise not to assert certain patent
        claims against other contributors and against implementers. The OpenID
        Foundation invites any interested party to bring to its attention any
        copyrights, patents, patent applications, or other proprietary rights
        that may cover technology that may be required to practice this
        specification.<a href="#section-appendix.b-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="Acknowledgements">
<section id="section-appendix.c">
      <h2 id="name-acknowledgements">
<a href="#section-appendix.c" class="section-number selfRef">Appendix C. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-appendix.c-1">
        The authors wish to acknowledge the contributions of the following
        individuals and organizations to this specification:
        Vladimir Dzhuvinov,
        Heather Flanagan,
        Jouke Roorda,
        Misha Salle,
        Marcos Sanz,
        Peter Schober,
        Michael Schwartz,
        and
        the JRA3T3 task force of GEANT4-2.<a href="#section-appendix.c-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="TBD">
<section id="section-appendix.d">
      <h2 id="name-open-issues">
<a href="#section-appendix.d" class="section-number selfRef">Appendix D. </a><a href="#name-open-issues" class="section-name selfRef">Open Issues</a>
      </h2>
<p id="section-appendix.d-1">
        The following open issues remain to be addressed in this specification.<a href="#section-appendix.d-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-2.1">
            The representation for RPs that are native applications needs to be
            defined.<a href="#section-appendix.d-2.1" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.d-2.2">
            How are federation operator keys retrieved?<a href="#section-appendix.d-2.2" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.d-2.3">
            A mechanism is needed for key rotation of federation operator keys
            for long-term security and maintainability of federations.<a href="#section-appendix.d-2.3" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.d-2.4">
            A mechanism may be needed for bounding key lifetimes.<a href="#section-appendix.d-2.4" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.d-2.5">
            Discuss that key IDs may be chosen as the JWK Thumbprint [RFC 7638]
            of the key.<a href="#section-appendix.d-2.5" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.d-2.6">
            Discuss localization of human-readable strings.<a href="#section-appendix.d-2.6" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.d-2.7">
            SAML2 as used in Research and Education federations uses
            post-/prefix
            matching on metadata in some cases. We might need something
            similar or just use regular expressions.<a href="#section-appendix.d-2.7" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.d-2.8">
            Define the relationship between trust anchors and Federation
            Operators,
            as people will expect to find the Federation Operator term in the
            specification.<a href="#section-appendix.d-2.8" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.d-2.9">
            Add a diagram showing the relationships between FOs, orgs, sub-orgs,
            and leaf entities.<a href="#section-appendix.d-2.9" class="pilcrow">Â¶</a>
</li>
      </ul>
</section>
</div>
<div id="History">
<section id="section-appendix.e">
      <h2 id="name-document-history">
<a href="#section-appendix.e" class="section-number selfRef">Appendix E. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="section-appendix.e-1">[[ To be removed from the final specification ]]<a href="#section-appendix.e-1" class="pilcrow">Â¶</a></p>
<p id="section-appendix.e-2">
        -15<a href="#section-appendix.e-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.e-3.1">
            Added signed_jwks_uri. Which had be lost somewhere down the road.<a href="#section-appendix.e-3.1" class="pilcrow">Â¶</a>
</li>
      </ul>
<p id="section-appendix.e-4">
        -14<a href="#section-appendix.e-4" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.e-5.1">
            Rewrote the federation policy section.<a href="#section-appendix.e-5.1" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-5.2">
            What previously was referred to as
            <code>client authentication</code> in connection
            with automatic client registration is now changed to be
            <code>request authentication</code>.<a href="#section-appendix.e-5.2" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-5.3">
            Made a distinction between parameters and claims.<a href="#section-appendix.e-5.3" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-5.4">
     Corrected the description of the intended behavior when
     <code>essential</code> is absent.<a href="#section-appendix.e-5.4" class="pilcrow">Â¶</a>
</li>
      </ul>
<p id="section-appendix.e-6">
        -13<a href="#section-appendix.e-6" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.e-7.1">
            Added 'trust_marks' as a parameter in the entity statement.<a href="#section-appendix.e-7.1" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-7.2">
            An RP's self-signed entity statement MUST have the OP's issuer
            identifier
            as the value of 'aud'.<a href="#section-appendix.e-7.2" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-7.3">
            Added RS256 as default signing algorithm for entity statements.<a href="#section-appendix.e-7.3" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-7.4">
            Specified that the value of 'aud' in the entity statement use in
            automatic client registration MUST have the ASs authorization
            endpoint
            URL as value. Also the 'sub' claim MUST NOT be present.<a href="#section-appendix.e-7.4" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-7.5">
            Separating the usage of merge and combine as proposed by Vladimir
            Dzhuvinov in Bitbucket issue #1157.<a href="#section-appendix.e-7.5" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-7.6">
            An RP doing only explicit client registration are not required to
            publish and support a .well-known/openid-federation endpoint.<a href="#section-appendix.e-7.6" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-7.7">
            Every key in a JWKS in an entity statement MUST have a kid.<a href="#section-appendix.e-7.7" class="pilcrow">Â¶</a>
</li>
      </ul>
<p id="section-appendix.e-8">
        -12<a href="#section-appendix.e-8" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.e-9.1">
            Made JWKS optional in an entity statement returned by OP as response
            of an explicit client registration<a href="#section-appendix.e-9.1" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-9.2">
            Renamed entity type to client registration type.<a href="#section-appendix.e-9.2" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-9.3">
            Added more text describing
            client_registration_auth_methods_supported.<a href="#section-appendix.e-9.3" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-9.4">
            Made "Processing the Authentication Request" into two separate
            sections:
            one for Authentication Request and one for Pushed Authorization
            Request.<a href="#section-appendix.e-9.4" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-9.5">
            Added example of URLs to some examples in the appendix.<a href="#section-appendix.e-9.5" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-9.6">
            Changed the automatic client registration example in the appendix to
            use
            Request Object instead of a client_assertion.<a href="#section-appendix.e-9.6" class="pilcrow">Â¶</a>
</li>
      </ul>
<p id="section-appendix.e-10">
        -11<a href="#section-appendix.e-10" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.e-11.1">
            Added section on trust marks.<a href="#section-appendix.e-11.1" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-11.2">
            Clarified private_key_jwt usage in the authentication request.<a href="#section-appendix.e-11.2" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-11.3">
            Fixed Bitbucket issues #1150 and #1155 by Vladimir Dzhuvinov.<a href="#section-appendix.e-11.3" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-11.4">
            Fixed some examples to make them syntactically correct.<a href="#section-appendix.e-11.4" class="pilcrow">Â¶</a>
</li>
      </ul>
<p id="section-appendix.e-12">
        -10<a href="#section-appendix.e-12" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.e-13.1">
            Incorporated additional review feedback from Marcos Sanz.
            The primary change was moving constraints to their own section of
            the
            entity statement.<a href="#section-appendix.e-13.1" class="pilcrow">Â¶</a>
</li>
      </ul>
<p id="section-appendix.e-14">
        -09<a href="#section-appendix.e-14" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.e-15.1">
            Incorporated review feedback from Marcos Sanz.
            Major changes were as follows.<a href="#section-appendix.e-15.1" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-15.2">
            Separated entity configuration discovery from operations provided
            by the federation API.<a href="#section-appendix.e-15.2" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-15.3">
            Defined new authentication error codes.<a href="#section-appendix.e-15.3" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-15.4">
            Also incorporated review feedback from Michael B. Jones.<a href="#section-appendix.e-15.4" class="pilcrow">Â¶</a>
</li>
      </ul>
<p id="section-appendix.e-16">
        -08<a href="#section-appendix.e-16" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.e-17.1">
            Incorporated review feedback from Michael B. Jones.
            Major changes were as follows.<a href="#section-appendix.e-17.1" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-17.2">
            Deleted <code>sub_is_leaf</code> entity statement
            since it was redundant.<a href="#section-appendix.e-17.2" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-17.3">
            Added <code>federation_type</code> RP registration
            metadata value
            and <code>federation_types_supported</code> OP
            metadata value.<a href="#section-appendix.e-17.3" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-17.4">
            Deleted <code>openid_discovery</code> metadata type
            identifier
            since its purpose is already served by
            <code>openid_provider</code>.<a href="#section-appendix.e-17.4" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-17.5">
            Entity identifier paths are now included when using the Federation
            API,
            enabling use in multi-tenant deployments sharing a common domain
            name.<a href="#section-appendix.e-17.5" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-17.6">
            Renamed <code>sub_is_leaf</code> to
            <code>is_leaf</code>
            in the Entity Listings Request operation parameters.<a href="#section-appendix.e-17.6" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-17.7">
            Added <code>crit</code> and
            <code>policy_language_crit</code>,
            enabling control over which entity statement and policy language
            extensions
            MUST be understood and processed.<a href="#section-appendix.e-17.7" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-17.8">
            Renamed <code>openid_client</code> to
            <code>openid_relying_party</code>.<a href="#section-appendix.e-17.8" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-17.9">
            Renamed <code>oauth_service</code> to
            <code>oauth_authorization_server</code>.<a href="#section-appendix.e-17.9" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-17.10">
            Renamed <code>implicit</code> registration to
            <code>automatic</code>
            registration
            to avoid naming confusion with the implicit grant type.<a href="#section-appendix.e-17.10" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-17.11">
            Renamed <code>op</code> to
            <code>operation</code>
            to avoid naming confusion with the use of "OP" as an acronym for
            "OpenID Provider".<a href="#section-appendix.e-17.11" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-17.12">
            Renamed <code>url</code> to
            <code>uri</code>
            in several identifiers.<a href="#section-appendix.e-17.12" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-17.13">
            Restored Open Issues appendix.<a href="#section-appendix.e-17.13" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-17.14">
            Corrected document formatting issues.<a href="#section-appendix.e-17.14" class="pilcrow">Â¶</a>
</li>
      </ul>
<p id="section-appendix.e-18">
        -07<a href="#section-appendix.e-18" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.e-19.1">
            Split metadata into metadata and metadata_policy<a href="#section-appendix.e-19.1" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-19.2">
            Updated example<a href="#section-appendix.e-19.2" class="pilcrow">Â¶</a>
</li>
      </ul>
<p id="section-appendix.e-20">
        -06<a href="#section-appendix.e-20" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.e-21.1">
            Some rewrites<a href="#section-appendix.e-21.1" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-21.2">
            Added example of explicit client registration<a href="#section-appendix.e-21.2" class="pilcrow">Â¶</a>
</li>
      </ul>
<p id="section-appendix.e-22">
        -05<a href="#section-appendix.e-22" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.e-23.1">
            A major rewrite.<a href="#section-appendix.e-23.1" class="pilcrow">Â¶</a>
</li>
      </ul>
<p id="section-appendix.e-24">
        -04<a href="#section-appendix.e-24" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.e-25.1">
            Changed client metadata names
            <code>scopes</code>
            to <code>rp_scopes</code> and
            <code>claims</code>
            to <code>rp_claims</code>.<a href="#section-appendix.e-25.1" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-25.2">
            Added Open Issues appendix.<a href="#section-appendix.e-25.2" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-25.3">
            Added additional references.<a href="#section-appendix.e-25.3" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-25.4">
            Editorial improvements.<a href="#section-appendix.e-25.4" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-appendix.e-25.5">
            Added standard Notices section, which is present in all OpenID
            specifications.<a href="#section-appendix.e-25.5" class="pilcrow">Â¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.f">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Roland Hedberg (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">independent</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:roland@catalogix.se" class="email">roland@catalogix.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael B. Jones</span></div>
<div dir="auto" class="left"><span class="org">Microsoft</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mbj@microsoft.com" class="email">mbj@microsoft.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="http://self-issued.info/" class="url">http://self-issued.info/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Andreas Ã…kre Solberg</span></div>
<div dir="auto" class="left"><span class="org">Uninett AS</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:andreas.solberg@uninett.no" class="email">andreas.solberg@uninett.no</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.linkedin.com/in/andreassolberg/" class="url">https://www.linkedin.com/in/andreassolberg/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Samuel Gulliksson</span></div>
<div dir="auto" class="left"><span class="org">Schibsted Media Group</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:samuel.gulliksson@gmail.com" class="email">samuel.gulliksson@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Bradley</span></div>
<div dir="auto" class="left"><span class="org">Yubico</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ve7jtb@ve7jtb.com" class="email">ve7jtb@ve7jtb.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="http://www.thread-safe.com/" class="url">http://www.thread-safe.com/</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
